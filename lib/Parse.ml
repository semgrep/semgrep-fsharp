(* Generated by ocaml-tree-sitter. *)

(*
   Disable warning 42:
     "this use of Foo relies on type-directed disambiguation,
     it will not compile with OCaml 4.00 or earlier."
*)
[@@@warning "-42"]

(* Disable warnings against unused variables. *)
[@@@warning "-26-27-32"]

open Tree_sitter_bindings
open Tree_sitter_run

let debug = ref false

type mt = Run.matcher_token

external create_parser :
  unit -> Tree_sitter_API.ts_parser = "octs_create_parser_fsharp"

let ts_parser = create_parser ()

let parse_source_string ?src_file contents =
  Tree_sitter_parsing.parse_source_string ?src_file ts_parser contents

let parse_source_file src_file =
  Tree_sitter_parsing.parse_source_file ts_parser src_file

let extras = [
]

let children_regexps : (string * Run.exp option) list = [
  "imm_tok_choice_ul_", None;
  "imm_tok_choice_ul", None;
  "imm_tok_dquot", None;
  "imm_tok_lpar", None;
  "pat_c3eb998", None;
  "bitdigit_imm", None;
  "imm_tok_hash", None;
  "digit_char_imm", None;
  "pat_9d988a2", None;
  "imm_tok_squot", None;
  "virtual_end_decl", None;
  "pat_0257738", None;
  "imm_tok_dquotdquotdquot", None;
  "simple_string_char", None;
  "imm_tok_squotb", None;
  "block_comment_content", None;
  "octaldigit_imm", None;
  "range_op_name",
  Some (
    Alt [|
      Token (Literal "..");
      Token (Literal ".. ..");
    |];
  );
  "escape_char", None;
  "imm_tok_l", None;
  "imm_tok_s", None;
  "pat_213dc3e", None;
  "pat_0o", None;
  "attribute_target",
  Some (
    Alt [|
      Token (Literal "assembly");
      Token (Literal "module");
      Token (Literal "return");
      Token (Literal "field");
      Token (Literal "property");
      Token (Literal "param");
      Token (Literal "type");
      Token (Literal "constructor");
      Token (Literal "event");
    |];
  );
  "imm_tok_lt", None;
  "imm_tok_dot", None;
  "imm_tok_pat_m", None;
  "imm_tok_f", None;
  "imm_tok_lf", None;
  "imm_tok_lbrack", None;
  "virtual_open_section", None;
  "imm_tok_lf_", None;
  "imm_tok_l_", None;
  "imm_tok_y", None;
  "imm_tok_bslashu", None;
  "imm_tok_un", None;
  "imm_tok_dquotb", None;
  "imm_tok_pat_35b22f4", None;
  "imm_tok_bslash", None;
  "imm_tok_uy", None;
  "pat_0b", None;
  "imm_tok_us", None;
  "pat_0x", None;
  "imm_tok_n", None;
  "non_escape_char", None;
  "hex_digit_imm", None;
  "simple_char_char", None;
  "imm_tok_bsla", None;
  "virtual_end_section", None;
  "float", None;
  "imm_tok_pat_684220d", None;
  "line_comment", None;
  "identifier",
  Some (
    Alt [|
      Token (Name "pat_c3eb998");
      Token (Name "pat_9d988a2");
    |];
  );
  "symbolic_op",
  Some (
    Alt [|
      Token (Literal "?");
      Token (Literal "?<-");
      Token (Name "pat_0257738");
      Alt [|
        Token (Literal "<@");
        Token (Literal "<@@");
      |];
      Alt [|
        Token (Literal "@>");
        Token (Literal "@@>");
      |];
    |];
  );
  "block_comment",
  Some (
    Seq [
      Token (Literal "(*");
      Token (Name "block_comment_content");
      Token (Literal "*)");
    ];
  );
  "int",
  Some (
    Seq [
      Token (Name "pat_213dc3e");
      Repeat (
        Token (Name "digit_char_imm");
      );
    ];
  );
  "trigraph",
  Some (
    Seq [
      Token (Name "imm_tok_bslash");
      Token (Name "digit_char_imm");
      Token (Name "digit_char_imm");
      Token (Name "digit_char_imm");
    ];
  );
  "verbatim_string_char",
  Some (
    Alt [|
      Token (Name "simple_string_char");
      Token (Name "non_escape_char");
      Token (Literal "\\");
    |];
  );
  "unicodegraph_long",
  Some (
    Seq [
      Token (Name "imm_tok_bslashu");
      Token (Name "hex_digit_imm");
      Token (Name "hex_digit_imm");
      Token (Name "hex_digit_imm");
      Token (Name "hex_digit_imm");
      Token (Name "hex_digit_imm");
      Token (Name "hex_digit_imm");
      Token (Name "hex_digit_imm");
      Token (Name "hex_digit_imm");
    ];
  );
  "xint",
  Some (
    Alt [|
      Seq [
        Token (Name "pat_0x");
        Repeat1 (
          Token (Name "hex_digit_imm");
        );
      ];
      Seq [
        Token (Name "pat_0o");
        Repeat1 (
          Token (Name "octaldigit_imm");
        );
      ];
      Seq [
        Token (Name "pat_0b");
        Repeat1 (
          Token (Name "bitdigit_imm");
        );
      ];
    |];
  );
  "unicodegraph_short",
  Some (
    Seq [
      Token (Name "imm_tok_bsla");
      Token (Name "hex_digit_imm");
      Token (Name "hex_digit_imm");
      Token (Name "hex_digit_imm");
      Token (Name "hex_digit_imm");
    ];
  );
  "unit",
  Some (
    Seq [
      Token (Literal "(");
      Opt (
        Seq [
          Token (Name "virtual_open_section");
          Token (Name "virtual_end_section");
        ];
      );
      Token (Literal ")");
    ];
  );
  "simple_or_escape_char",
  Some (
    Alt [|
      Token (Name "escape_char");
      Token (Name "imm_tok_pat_684220d");
    |];
  );
  "type_argument",
  Some (
    Alt [|
      Token (Literal "_");
      Seq [
        Token (Literal "'");
        Token (Name "identifier");
      ];
      Seq [
        Token (Literal "^");
        Token (Name "identifier");
      ];
    |];
  );
  "property_or_ident",
  Some (
    Alt [|
      Seq [
        Token (Name "identifier");
        Token (Literal ".");
        Token (Name "identifier");
      ];
      Token (Name "identifier");
    |];
  );
  "static_type_argument",
  Some (
    Alt [|
      Seq [
        Alt [|
          Token (Literal "^");
          Token (Literal "'");
        |];
        Token (Name "identifier");
      ];
      Seq [
        Alt [|
          Token (Literal "^");
          Token (Literal "'");
        |];
        Token (Name "identifier");
        Repeat (
          Seq [
            Token (Literal "or");
            Alt [|
              Token (Literal "^");
              Token (Literal "'");
            |];
            Token (Name "identifier");
          ];
        );
      ];
    |];
  );
  "active_pattern_op_name",
  Some (
    Alt [|
      Seq [
        Token (Literal "|");
        Token (Name "identifier");
        Repeat1 (
          Seq [
            Token (Literal "|");
            Token (Name "identifier");
          ];
        );
        Token (Literal "|");
      ];
      Seq [
        Token (Literal "|");
        Token (Name "identifier");
        Repeat (
          Seq [
            Token (Literal "|");
            Token (Name "identifier");
          ];
        );
        Token (Literal "|");
        Token (Literal "_");
        Token (Literal "|");
      ];
    |];
  );
  "as_defn",
  Some (
    Seq [
      Token (Literal "as");
      Token (Name "identifier");
    ];
  );
  "long_identifier",
  Some (
    Seq [
      Token (Name "identifier");
      Repeat (
        Seq [
          Token (Literal ".");
          Token (Name "identifier");
        ];
      );
    ];
  );
  "prefix_op",
  Some (
    Alt [|
      Alt [|
        Token (Literal "+");
        Token (Literal "-");
        Token (Literal "+.");
        Token (Literal "-.");
        Token (Literal "%");
        Token (Literal "&");
        Token (Literal "&&");
      |];
      Repeat1 (
        Token (Literal "~");
      );
      Token (Name "symbolic_op");
    |];
  );
  "infix_op",
  Some (
    Alt [|
      Alt [|
        Token (Literal "+");
        Token (Literal "-");
        Token (Literal "+.");
        Token (Literal "-.");
        Token (Literal "%");
        Token (Literal "&");
        Token (Literal "&&");
      |];
      Token (Name "symbolic_op");
      Token (Literal "||");
      Token (Literal "=");
      Token (Literal "!=");
      Token (Literal ":=");
      Token (Literal "::");
      Token (Literal "$");
      Token (Literal "or");
      Token (Literal "?");
    |];
  );
  "bignum",
  Some (
    Seq [
      Token (Name "int");
      Token (Name "imm_tok_pat_35b22f4");
    ];
  );
  "decimal",
  Some (
    Seq [
      Alt [|
        Token (Name "float");
        Token (Name "int");
      |];
      Token (Name "imm_tok_pat_m");
    ];
  );
  "verbatim_string",
  Some (
    Seq [
      Token (Literal "@\"");
      Repeat (
        Token (Name "verbatim_string_char");
      );
      Token (Name "imm_tok_dquot");
    ];
  );
  "verbatim_bytearray",
  Some (
    Seq [
      Token (Literal "@\"");
      Repeat (
        Token (Name "verbatim_string_char");
      );
      Token (Name "imm_tok_dquotb");
    ];
  );
  "int32",
  Some (
    Seq [
      Alt [|
        Token (Name "int");
        Token (Name "xint");
      |];
      Token (Name "imm_tok_l");
    ];
  );
  "int16",
  Some (
    Seq [
      Alt [|
        Token (Name "int");
        Token (Name "xint");
      |];
      Token (Name "imm_tok_s");
    ];
  );
  "ieee64",
  Some (
    Seq [
      Token (Name "xint");
      Token (Name "imm_tok_lf_");
    ];
  );
  "int64",
  Some (
    Seq [
      Alt [|
        Token (Name "int");
        Token (Name "xint");
      |];
      Token (Name "imm_tok_l_");
    ];
  );
  "byte",
  Some (
    Seq [
      Alt [|
        Token (Name "int");
        Token (Name "xint");
      |];
      Token (Name "imm_tok_uy");
    ];
  );
  "uint32",
  Some (
    Seq [
      Alt [|
        Token (Name "int");
        Token (Name "xint");
      |];
      Token (Name "imm_tok_choice_ul");
    ];
  );
  "sbyte",
  Some (
    Seq [
      Alt [|
        Token (Name "int");
        Token (Name "xint");
      |];
      Token (Name "imm_tok_y");
    ];
  );
  "uint64",
  Some (
    Seq [
      Alt [|
        Token (Name "int");
        Token (Name "xint");
      |];
      Token (Name "imm_tok_choice_ul_");
    ];
  );
  "unativeint",
  Some (
    Seq [
      Alt [|
        Token (Name "int");
        Token (Name "xint");
      |];
      Token (Name "imm_tok_un");
    ];
  );
  "ieee32",
  Some (
    Alt [|
      Seq [
        Token (Name "float");
        Token (Name "imm_tok_f");
      ];
      Seq [
        Token (Name "xint");
        Token (Name "imm_tok_lf");
      ];
    |];
  );
  "nativeint",
  Some (
    Seq [
      Alt [|
        Token (Name "int");
        Token (Name "xint");
      |];
      Token (Name "imm_tok_n");
    ];
  );
  "uint16",
  Some (
    Seq [
      Alt [|
        Token (Name "int");
        Token (Name "xint");
      |];
      Token (Name "imm_tok_us");
    ];
  );
  "char_char",
  Some (
    Alt [|
      Token (Name "simple_char_char");
      Token (Name "escape_char");
      Token (Name "trigraph");
      Token (Name "unicodegraph_short");
    |];
  );
  "string_char",
  Some (
    Alt [|
      Token (Name "simple_string_char");
      Token (Name "escape_char");
      Token (Name "non_escape_char");
      Token (Name "trigraph");
      Token (Name "unicodegraph_short");
      Token (Name "unicodegraph_long");
    |];
  );
  "triple_quoted_string",
  Some (
    Seq [
      Token (Literal "\"\"\"");
      Repeat (
        Token (Name "simple_or_escape_char");
      );
      Token (Name "imm_tok_dquotdquotdquot");
    ];
  );
  "op_name",
  Some (
    Alt [|
      Token (Name "symbolic_op");
      Token (Name "range_op_name");
      Token (Name "active_pattern_op_name");
    |];
  );
  "import_decl",
  Some (
    Seq [
      Token (Literal "open");
      Token (Name "long_identifier");
    ];
  );
  "module_abbrev",
  Some (
    Seq [
      Token (Literal "module");
      Token (Name "identifier");
      Token (Literal "=");
      Token (Name "virtual_open_section");
      Token (Name "long_identifier");
      Token (Name "virtual_end_section");
    ];
  );
  "bytechar",
  Some (
    Seq [
      Token (Literal "'");
      Token (Name "char_char");
      Token (Name "imm_tok_squotb");
    ];
  );
  "char",
  Some (
    Seq [
      Token (Literal "'");
      Token (Name "char_char");
      Token (Name "imm_tok_squot");
    ];
  );
  "bytearray",
  Some (
    Seq [
      Token (Literal "\"");
      Repeat (
        Token (Name "string_char");
      );
      Token (Name "imm_tok_dquotb");
    ];
  );
  "string",
  Some (
    Seq [
      Token (Literal "\"");
      Repeat (
        Token (Name "string_char");
      );
      Token (Name "imm_tok_dquot");
    ];
  );
  "identifier_or_op",
  Some (
    Alt [|
      Token (Name "identifier");
      Seq [
        Token (Literal "(");
        Token (Name "op_name");
        Token (Literal ")");
      ];
      Token (Literal "(*)");
    |];
  );
  "compiler_directive_decl",
  Some (
    Seq [
      Token (Literal "#nowarn");
      Repeat (
        Token (Name "string");
      );
    ];
  );
  "fsi_directive_decl",
  Some (
    Alt [|
      Seq [
        Token (Literal "#r");
        Repeat (
          Token (Name "string");
        );
      ];
      Seq [
        Token (Literal "#load");
        Repeat (
          Token (Name "string");
        );
      ];
    |];
  );
  "const",
  Some (
    Alt [|
      Token (Name "sbyte");
      Token (Name "int16");
      Token (Name "int32");
      Token (Name "int64");
      Token (Name "byte");
      Token (Name "uint16");
      Token (Name "uint32");
      Token (Name "int");
      Token (Name "nativeint");
      Token (Name "unativeint");
      Token (Name "decimal");
      Token (Name "uint64");
      Token (Name "ieee32");
      Token (Name "ieee64");
      Token (Name "bignum");
      Token (Name "char");
      Token (Name "string");
      Token (Name "verbatim_string");
      Token (Name "triple_quoted_string");
      Token (Name "bytearray");
      Token (Name "verbatim_bytearray");
      Token (Name "bytechar");
      Token (Literal "false");
      Token (Literal "true");
      Token (Name "unit");
    |];
  );
  "long_identifier_or_op",
  Some (
    Alt [|
      Token (Name "long_identifier");
      Seq [
        Token (Name "long_identifier");
        Token (Literal ".");
        Token (Name "identifier_or_op");
      ];
      Token (Name "identifier_or_op");
    |];
  );
  "pattern_param",
  Some (
    Alt [|
      Token (Name "const");
      Token (Name "long_identifier");
      Token (Literal "null");
    |];
  );
  "enum_type_case",
  Some (
    Seq [
      Token (Name "identifier");
      Token (Literal "=");
      Token (Name "const");
    ];
  );
  "additional_constr_defn",
  Some (
    Seq [
      Opt (
        Alt [|
          Token (Literal "private");
          Token (Literal "internal");
          Token (Literal "public");
        |];
      );
      Token (Literal "new");
      Token (Name "pattern");
      Token (Name "as_defn");
      Token (Literal "=");
    ];
  );
  "application_expression",
  Some (
    Seq [
      Token (Name "expression_inner");
      Repeat1 (
        Token (Name "expression_inner");
      );
    ];
  );
  "argument_patterns",
  Some (
    Repeat1 (
      Token (Name "atomic_pattern");
    );
  );
  "array_expression",
  Some (
    Seq [
      Token (Literal "[|");
      Opt (
        Token (Name "list_element");
      );
      Token (Literal "|]");
    ];
  );
  "array_pattern",
  Some (
    Alt [|
      Seq [
        Token (Literal "[|");
        Token (Literal "|]");
      ];
      Seq [
        Token (Literal "[|");
        Token (Name "pattern");
        Repeat (
          Seq [
            Token (Literal ";");
            Token (Name "pattern");
          ];
        );
        Token (Literal "|]");
      ];
    |];
  );
  "as_pattern",
  Some (
    Seq [
      Token (Name "pattern");
      Token (Literal "as");
      Token (Name "identifier");
    ];
  );
  "atomic_pattern",
  Some (
    Alt [|
      Token (Literal "null");
      Token (Literal "_");
      Token (Name "const");
      Token (Name "long_identifier");
      Token (Name "list_pattern");
      Token (Name "record_pattern");
      Token (Name "array_pattern");
      Seq [
        Token (Literal "(");
        Token (Name "virtual_open_section");
        Token (Name "pattern");
        Token (Name "virtual_end_section");
        Token (Literal ")");
      ];
    |];
  );
  "attribute",
  Some (
    Seq [
      Opt (
        Seq [
          Token (Name "attribute_target");
          Token (Literal ":");
        ];
      );
      Token (Name "object_construction");
    ];
  );
  "attribute_pattern",
  Some (
    Seq [
      Token (Name "attributes");
      Token (Name "pattern");
    ];
  );
  "attribute_set",
  Some (
    Seq [
      Token (Literal "[<");
      Token (Name "attribute");
      Repeat (
        Seq [
          Token (Literal ";");
          Token (Name "attribute");
        ];
      );
      Token (Literal ">]");
    ];
  );
  "attributes",
  Some (
    Repeat1 (
      Token (Name "attribute_set");
    );
  );
  "begin_end_expression",
  Some (
    Seq [
      Token (Literal "begin");
      Token (Name "expressions");
      Token (Literal "end");
    ];
  );
  "brace_expression",
  Some (
    Seq [
      Token (Literal "{");
      Alt [|
        Token (Name "with_field_expression");
        Token (Name "field_expression");
        Token (Name "object_expression");
      |];
      Token (Literal "}");
    ];
  );
  "call_expression",
  Some (
    Seq [
      Token (Name "expression_inner");
      Token (Name "imm_tok_lpar");
      Opt (
        Token (Name "expressions");
      );
      Token (Literal ")");
    ];
  );
  "ce_expression",
  Some (
    Seq [
      Token (Name "expression_inner");
      Token (Literal "{");
      Token (Name "virtual_open_section");
      Token (Name "comp_or_range_expression");
      Token (Name "virtual_end_section");
      Token (Literal "}");
    ];
  );
  "comp_or_range_expression",
  Some (
    Alt [|
      Token (Name "expressions");
      Token (Name "short_comp_expression");
    |];
  );
  "conjunct_pattern",
  Some (
    Seq [
      Token (Name "pattern");
      Token (Literal "&");
      Token (Name "pattern");
    ];
  );
  "cons_pattern",
  Some (
    Seq [
      Token (Name "pattern");
      Token (Literal "::");
      Token (Name "pattern");
    ];
  );
  "constraint",
  Some (
    Alt [|
      Seq [
        Token (Name "type_argument");
        Token (Literal ":>");
        Token (Name "type");
      ];
      Seq [
        Token (Name "type_argument");
        Token (Literal ":");
        Token (Literal "null");
      ];
      Seq [
        Token (Name "static_type_argument");
        Token (Literal ":");
        Token (Literal "(");
        Token (Name "trait_member_constraint");
        Token (Literal ")");
      ];
      Seq [
        Token (Name "type_argument");
        Token (Literal ":");
        Token (Literal "(");
        Token (Literal "new");
        Token (Literal ":");
        Token (Literal "unit");
        Token (Literal "->");
        Token (Literal "'T");
        Token (Literal ")");
      ];
      Seq [
        Token (Name "type_argument");
        Token (Literal ":");
        Token (Literal "struct");
      ];
      Seq [
        Token (Name "type_argument");
        Token (Literal ":");
        Token (Literal "not");
        Token (Literal "struct");
      ];
      Seq [
        Token (Name "type_argument");
        Token (Literal ":");
        Token (Literal "enum");
        Token (Literal "<");
        Token (Name "type");
        Token (Literal ">");
      ];
      Seq [
        Token (Name "type_argument");
        Token (Literal ":");
        Token (Literal "unmanaged");
      ];
      Seq [
        Token (Name "type_argument");
        Token (Literal ":");
        Token (Literal "equality");
      ];
      Seq [
        Token (Name "type_argument");
        Token (Literal ":");
        Token (Literal "comparison");
      ];
      Seq [
        Token (Name "type_argument");
        Token (Literal ":");
        Token (Literal "delegate");
        Token (Literal "<");
        Token (Name "type");
        Token (Literal ",");
        Token (Name "type");
        Token (Literal ">");
      ];
    |];
  );
  "declaration_expression",
  Some (
    Seq [
      Alt [|
        Seq [
          Alt [|
            Token (Literal "use");
            Token (Literal "use!");
          |];
          Token (Name "identifier");
          Token (Literal "=");
          Token (Name "virtual_open_section");
          Token (Name "expressions");
          Token (Name "virtual_end_section");
        ];
        Token (Name "function_or_value_defn");
      |];
      Token (Name "virtual_open_section");
      Token (Name "expressions");
      Token (Name "virtual_end_section");
    ];
  );
  "disjunct_pattern",
  Some (
    Seq [
      Token (Name "pattern");
      Token (Literal "|");
      Token (Name "pattern");
    ];
  );
  "do_expression",
  Some (
    Seq [
      Alt [|
        Token (Literal "do");
        Token (Literal "do!");
      |];
      Token (Name "virtual_open_section");
      Token (Name "expressions");
      Token (Name "virtual_end_section");
    ];
  );
  "dot_expression",
  Some (
    Seq [
      Token (Name "expression_inner");
      Token (Name "imm_tok_dot");
      Token (Name "long_identifier_or_op");
    ];
  );
  "elif_expression",
  Some (
    Seq [
      Token (Literal "elif");
      Token (Name "expression_inner");
      Token (Literal "then");
      Token (Name "virtual_open_section");
      Token (Name "expressions");
      Token (Name "virtual_end_section");
    ];
  );
  "else_expression",
  Some (
    Seq [
      Token (Literal "else");
      Token (Name "virtual_open_section");
      Token (Name "expressions");
      Token (Name "virtual_end_section");
    ];
  );
  "expression_inner",
  Some (
    Alt [|
      Token (Name "line_comment");
      Token (Name "block_comment");
      Token (Name "const");
      Token (Name "paren_expression");
      Token (Name "begin_end_expression");
      Token (Name "long_identifier_or_op");
      Token (Name "dot_expression");
      Token (Name "typed_expression");
      Token (Name "infix_expression");
      Token (Name "index_expression");
      Token (Name "mutate_expression");
      Token (Name "object_instantiation_expression");
      Token (Name "list_expression");
      Token (Name "array_expression");
      Token (Name "ce_expression");
      Token (Name "prefixed_expression");
      Token (Name "brace_expression");
      Token (Literal "null");
      Token (Name "typecast_expression");
      Token (Name "declaration_expression");
      Token (Name "do_expression");
      Token (Name "fun_expression");
      Token (Name "function_expression");
      Token (Name "if_expression");
      Token (Name "while_expression");
      Token (Name "for_expression");
      Token (Name "match_expression");
      Token (Name "try_expression");
      Token (Name "literal_expression");
      Token (Name "call_expression");
      Token (Name "tuple_expression");
      Token (Name "application_expression");
      Token (Name "return_expression");
      Token (Name "yield_expression");
    |];
  );
  "expressions",
  Some (
    Alt [|
      Token (Name "seq_infix");
      Seq [
        Token (Name "expression_inner");
        Repeat (
          Seq [
            Token (Name "virtual_end_decl");
            Token (Name "expressions");
          ];
        );
      ];
    |];
  );
  "field_expression",
  Some (
    Token (Name "field_initializers");
  );
  "field_initializer",
  Some (
    Seq [
      Token (Name "long_identifier");
      Token (Literal "=");
      Token (Name "virtual_open_section");
      Token (Name "expressions");
      Token (Name "virtual_end_section");
    ];
  );
  "field_initializers",
  Some (
    Seq [
      Token (Name "field_initializer");
      Repeat (
        Seq [
          Token (Name "virtual_end_decl");
          Token (Name "field_initializer");
        ];
      );
    ];
  );
  "field_pattern",
  Some (
    Seq [
      Token (Name "long_identifier");
      Token (Literal "=");
      Token (Name "pattern");
    ];
  );
  "for_expression",
  Some (
    Seq [
      Token (Literal "for");
      Alt [|
        Seq [
          Token (Name "pattern");
          Token (Literal "in");
          Alt [|
            Token (Name "expression_inner");
            Token (Name "range_expression");
          |];
        ];
        Seq [
          Token (Name "identifier");
          Token (Literal "=");
          Token (Name "expression_inner");
          Alt [|
            Token (Literal "to");
            Token (Literal "downto");
          |];
          Token (Name "expression_inner");
        ];
      |];
      Token (Literal "do");
      Token (Name "virtual_open_section");
      Token (Name "expressions");
      Token (Name "virtual_end_section");
      Opt (
        Token (Literal "done");
      );
    ];
  );
  "fun_expression",
  Some (
    Seq [
      Token (Literal "fun");
      Token (Name "argument_patterns");
      Token (Literal "->");
      Token (Name "virtual_open_section");
      Token (Name "expressions");
      Token (Name "virtual_end_section");
    ];
  );
  "function_declaration_left",
  Some (
    Seq [
      Opt (
        Token (Literal "inline");
      );
      Opt (
        Alt [|
          Token (Literal "private");
          Token (Literal "internal");
          Token (Literal "public");
        |];
      );
      Token (Name "identifier_or_op");
      Opt (
        Token (Name "type_arguments");
      );
      Token (Name "argument_patterns");
      Opt (
        Seq [
          Token (Literal ":");
          Token (Name "type");
        ];
      );
    ];
  );
  "function_expression",
  Some (
    Seq [
      Token (Literal "function");
      Token (Name "rules");
    ];
  );
  "function_or_value_defn",
  Some (
    Seq [
      Alt [|
        Token (Literal "let");
        Token (Literal "let!");
      |];
      Alt [|
        Token (Name "function_or_value_defn_body");
        Seq [
          Token (Literal "rec");
          Token (Name "function_or_value_defns");
        ];
      |];
    ];
  );
  "function_or_value_defn_body",
  Some (
    Seq [
      Alt [|
        Token (Name "function_declaration_left");
        Token (Name "value_declaration_left");
      |];
      Token (Literal "=");
      Token (Name "virtual_open_section");
      Token (Name "expressions");
      Token (Name "virtual_end_section");
    ];
  );
  "function_or_value_defns",
  Some (
    Seq [
      Token (Name "function_or_value_defn_body");
      Repeat1 (
        Seq [
          Token (Literal "and");
          Token (Name "function_or_value_defn_body");
        ];
      );
    ];
  );
  "identifier_pattern",
  Some (
    Seq [
      Token (Name "long_identifier");
      Opt (
        Token (Name "pattern_param");
      );
      Opt (
        Token (Name "pattern");
      );
    ];
  );
  "if_expression",
  Some (
    Seq [
      Token (Literal "if");
      Token (Name "expression_inner");
      Token (Literal "then");
      Token (Name "expressions");
      Repeat (
        Token (Name "elif_expression");
      );
      Opt (
        Token (Name "else_expression");
      );
    ];
  );
  "index_expression",
  Some (
    Seq [
      Token (Name "expression_inner");
      Opt (
        Token (Name "imm_tok_dot");
      );
      Token (Name "imm_tok_lbrack");
      Token (Name "virtual_open_section");
      Alt [|
        Token (Name "expressions");
        Token (Name "slice_ranges");
      |];
      Token (Name "virtual_end_section");
      Token (Literal "]");
    ];
  );
  "infix_expression",
  Some (
    Seq [
      Token (Name "expression_inner");
      Token (Name "infix_op");
      Token (Name "expression_inner");
    ];
  );
  "interface_implementation",
  Some (
    Seq [
      Token (Literal "interface");
      Token (Name "type");
      Opt (
        Token (Name "object_members");
      );
    ];
  );
  "interface_implementations",
  Some (
    Repeat1 (
      Token (Name "interface_implementation");
    );
  );
  "list_element",
  Some (
    Alt [|
      Token (Name "list_elements");
      Token (Name "comp_or_range_expression");
    |];
  );
  "list_elements",
  Some (
    Seq [
      Token (Name "virtual_open_section");
      Token (Name "expression_inner");
      Repeat (
        Seq [
          Token (Name "virtual_end_decl");
          Token (Name "expression_inner");
        ];
      );
      Token (Name "virtual_end_section");
    ];
  );
  "list_expression",
  Some (
    Seq [
      Token (Literal "[");
      Opt (
        Token (Name "list_element");
      );
      Token (Literal "]");
    ];
  );
  "list_pattern",
  Some (
    Alt [|
      Seq [
        Token (Literal "[");
        Token (Literal "]");
      ];
      Seq [
        Token (Literal "[");
        Token (Name "pattern");
        Repeat (
          Seq [
            Token (Literal ";");
            Token (Name "pattern");
          ];
        );
        Token (Literal "]");
      ];
    |];
  );
  "literal_expression",
  Some (
    Alt [|
      Seq [
        Token (Literal "<@");
        Token (Name "expression_inner");
        Token (Literal "@>");
      ];
      Seq [
        Token (Literal "<@@");
        Token (Name "expression_inner");
        Token (Literal "@@>");
      ];
    |];
  );
  "match_expression",
  Some (
    Seq [
      Alt [|
        Token (Literal "match");
        Token (Literal "match!");
      |];
      Token (Name "expression_inner");
      Token (Literal "with");
      Token (Name "rules");
    ];
  );
  "member_defn",
  Some (
    Seq [
      Opt (
        Token (Name "attributes");
      );
      Alt [|
        Seq [
          Opt (
            Token (Literal "static");
          );
          Token (Literal "member");
          Opt (
            Alt [|
              Token (Literal "private");
              Token (Literal "internal");
              Token (Literal "public");
            |];
          );
          Token (Name "method_or_prop_defn");
        ];
        Seq [
          Token (Literal "abstract");
          Opt (
            Token (Literal "member");
          );
          Opt (
            Alt [|
              Token (Literal "private");
              Token (Literal "internal");
              Token (Literal "public");
            |];
          );
          Token (Name "member_signature");
        ];
        Seq [
          Token (Literal "override");
          Opt (
            Alt [|
              Token (Literal "private");
              Token (Literal "internal");
              Token (Literal "public");
            |];
          );
          Token (Name "method_or_prop_defn");
        ];
        Seq [
          Token (Literal "default");
          Opt (
            Alt [|
              Token (Literal "private");
              Token (Literal "internal");
              Token (Literal "public");
            |];
          );
          Token (Name "method_or_prop_defn");
        ];
        Seq [
          Opt (
            Token (Literal "static");
          );
          Token (Literal "val");
          Opt (
            Token (Literal "mutable");
          );
          Opt (
            Alt [|
              Token (Literal "private");
              Token (Literal "internal");
              Token (Literal "public");
            |];
          );
          Token (Name "identifier");
          Token (Literal ":");
          Token (Name "type");
        ];
        Token (Name "additional_constr_defn");
      |];
    ];
  );
  "member_defns",
  Some (
    Seq [
      Token (Name "member_defn");
      Repeat (
        Seq [
          Token (Name "virtual_end_decl");
          Token (Name "member_defn");
        ];
      );
    ];
  );
  "member_signature",
  Some (
    Seq [
      Token (Name "identifier");
      Opt (
        Token (Name "type_arguments");
      );
      Token (Literal ":");
      Token (Name "type");
      Opt (
        Alt [|
          Seq [
            Token (Literal "with");
            Token (Literal "get");
          ];
          Seq [
            Token (Literal "with");
            Token (Literal "set");
          ];
          Seq [
            Token (Literal "with");
            Token (Literal "get");
            Token (Literal ",");
            Token (Literal "set");
          ];
          Seq [
            Token (Literal "with");
            Token (Literal "set");
            Token (Literal ",");
            Token (Literal "get");
          ];
        |];
      );
    ];
  );
  "method_defn",
  Some (
    Alt [|
      Seq [
        Token (Name "property_or_ident");
        Token (Name "pattern");
        Token (Literal "=");
        Token (Name "virtual_open_section");
        Token (Name "expressions");
        Token (Name "virtual_end_section");
      ];
    |];
  );
  "method_or_prop_defn",
  Some (
    Alt [|
      Seq [
        Token (Name "property_or_ident");
        Token (Literal "with");
        Token (Name "virtual_open_section");
        Token (Name "function_or_value_defns");
        Token (Name "virtual_end_section");
      ];
      Token (Name "method_defn");
      Token (Name "property_defn");
    |];
  );
  "mutate_expression",
  Some (
    Seq [
      Token (Name "expression_inner");
      Token (Literal "<-");
      Token (Name "expression_inner");
    ];
  );
  "object_construction",
  Some (
    Seq [
      Token (Name "type");
      Opt (
        Token (Name "expressions");
      );
    ];
  );
  "object_expression",
  Some (
    Seq [
      Token (Literal "new");
      Alt [|
        Token (Name "object_construction");
        Seq [
          Token (Name "object_construction");
          Token (Literal "as");
          Token (Name "identifier");
        ];
      |];
      Token (Name "virtual_open_section");
      Token (Name "object_members");
      Token (Name "interface_implementations");
      Token (Name "virtual_end_section");
    ];
  );
  "object_instantiation_expression",
  Some (
    Seq [
      Token (Literal "new");
      Token (Name "type");
      Token (Name "imm_tok_lpar");
      Token (Name "expression_inner");
      Token (Literal ")");
    ];
  );
  "object_members",
  Some (
    Seq [
      Token (Literal "with");
      Token (Name "virtual_open_section");
      Token (Name "member_defns");
      Token (Name "virtual_end_section");
    ];
  );
  "paren_expression",
  Some (
    Seq [
      Token (Literal "(");
      Token (Name "virtual_open_section");
      Token (Name "expressions");
      Token (Name "virtual_end_section");
      Token (Literal ")");
    ];
  );
  "paren_pattern",
  Some (
    Seq [
      Token (Literal "(");
      Token (Name "virtual_open_section");
      Token (Name "pattern");
      Token (Name "virtual_end_section");
      Token (Literal ")");
    ];
  );
  "pattern",
  Some (
    Alt [|
      Token (Literal "null");
      Token (Literal "_");
      Token (Name "const");
      Token (Name "identifier_pattern");
      Token (Name "as_pattern");
      Token (Name "disjunct_pattern");
      Token (Name "conjunct_pattern");
      Token (Name "cons_pattern");
      Token (Name "repeat_pattern");
      Token (Name "paren_pattern");
      Token (Name "list_pattern");
      Token (Name "array_pattern");
      Token (Name "record_pattern");
      Token (Name "typed_pattern");
      Token (Name "attribute_pattern");
    |];
  );
  "prefixed_expression",
  Some (
    Seq [
      Alt [|
        Token (Literal "lazy");
        Token (Literal "assert");
        Token (Literal "upcast");
        Token (Literal "downcast");
        Token (Literal "%");
        Token (Literal "%%");
        Token (Name "prefix_op");
      |];
      Token (Name "expression_inner");
    ];
  );
  "property_defn",
  Some (
    Seq [
      Token (Name "property_or_ident");
      Token (Literal "=");
      Token (Name "virtual_open_section");
      Token (Name "expressions");
      Token (Name "virtual_end_section");
      Opt (
        Seq [
          Token (Literal "with");
          Alt [|
            Token (Literal "get");
            Token (Literal "set");
            Seq [
              Token (Literal "get");
              Token (Literal ",");
              Token (Literal "set");
            ];
            Seq [
              Token (Literal "set");
              Token (Literal ",");
              Token (Literal "get");
            ];
          |];
        ];
      );
    ];
  );
  "range_expression",
  Some (
    Seq [
      Token (Name "expressions");
      Token (Literal "..");
      Token (Name "expressions");
      Opt (
        Seq [
          Token (Literal "..");
          Token (Name "expressions");
        ];
      );
    ];
  );
  "record_pattern",
  Some (
    Seq [
      Token (Literal "{");
      Token (Name "field_pattern");
      Repeat (
        Seq [
          Token (Literal ";");
          Token (Name "field_pattern");
        ];
      );
    ];
  );
  "repeat_pattern",
  Some (
    Seq [
      Token (Name "pattern");
      Token (Literal ",");
      Repeat (
        Seq [
          Token (Name "virtual_end_decl");
          Token (Name "pattern");
          Token (Literal ",");
        ];
      );
      Token (Name "pattern");
    ];
  );
  "return_expression",
  Some (
    Seq [
      Alt [|
        Token (Literal "return");
        Token (Literal "return!");
      |];
      Token (Name "expression_inner");
    ];
  );
  "rule",
  Some (
    Seq [
      Token (Name "pattern");
      Token (Literal "->");
      Token (Name "virtual_open_section");
      Token (Name "expressions");
      Token (Name "virtual_end_section");
    ];
  );
  "rules",
  Some (
    Seq [
      Token (Name "virtual_open_section");
      Opt (
        Token (Literal "|");
      );
      Token (Name "rule");
      Repeat (
        Seq [
          Token (Literal "|");
          Token (Name "rule");
        ];
      );
      Token (Name "virtual_end_section");
    ];
  );
  "seq_infix",
  Some (
    Seq [
      Token (Name "expression_inner");
      Repeat1 (
        Seq [
          Token (Name "virtual_end_decl");
          Token (Name "infix_op");
          Token (Name "expressions");
        ];
      );
    ];
  );
  "short_comp_expression",
  Some (
    Seq [
      Token (Literal "for");
      Token (Name "pattern");
      Token (Literal "in");
      Alt [|
        Token (Name "expression_inner");
        Token (Name "range_expression");
      |];
      Token (Literal "->");
      Token (Name "expressions");
    ];
  );
  "slice_range",
  Some (
    Alt [|
      Token (Name "slice_range_special");
      Token (Name "expressions");
      Token (Literal "*");
    |];
  );
  "slice_range_special",
  Some (
    Alt [|
      Seq [
        Token (Name "expressions");
        Token (Literal "..");
      ];
      Seq [
        Token (Literal "..");
        Token (Name "expressions");
      ];
      Seq [
        Token (Name "expressions");
        Token (Literal "..");
        Token (Name "expressions");
      ];
    |];
  );
  "slice_ranges",
  Some (
    Seq [
      Token (Name "slice_range");
      Repeat (
        Seq [
          Token (Literal ",");
          Token (Name "slice_range");
        ];
      );
    ];
  );
  "trait_member_constraint",
  Some (
    Seq [
      Opt (
        Token (Literal "static");
      );
      Token (Literal "member");
      Token (Name "identifier");
      Token (Literal ":");
      Token (Name "type");
    ];
  );
  "try_expression",
  Some (
    Seq [
      Token (Literal "try");
      Token (Name "virtual_open_section");
      Token (Name "expressions");
      Token (Name "virtual_end_section");
      Alt [|
        Seq [
          Token (Literal "with");
          Token (Name "rules");
        ];
        Seq [
          Token (Literal "finally");
          Token (Name "virtual_open_section");
          Token (Name "expressions");
          Token (Name "virtual_end_section");
        ];
      |];
    ];
  );
  "tuple_expression",
  Some (
    Seq [
      Token (Name "expression_inner");
      Repeat1 (
        Seq [
          Token (Literal ",");
          Token (Name "expression_inner");
        ];
      );
    ];
  );
  "type",
  Some (
    Alt [|
      Token (Name "long_identifier");
      Seq [
        Token (Name "long_identifier");
        Token (Literal "<");
        Opt (
          Token (Name "type_attributes");
        );
        Token (Literal ">");
      ];
      Seq [
        Token (Literal "(");
        Token (Name "type");
        Token (Literal ")");
      ];
      Seq [
        Token (Name "type");
        Token (Literal "->");
        Token (Name "type");
      ];
      Seq [
        Token (Name "type");
        Repeat1 (
          Seq [
            Token (Literal "*");
            Token (Name "type");
          ];
        );
      ];
      Seq [
        Token (Name "type");
        Token (Name "long_identifier");
      ];
      Seq [
        Token (Name "type");
        Token (Literal "[");
        Repeat (
          Token (Literal ",");
        );
        Token (Literal "]");
      ];
      Seq [
        Token (Name "type");
        Token (Name "type_argument_defn");
      ];
      Token (Name "type_argument");
      Seq [
        Token (Name "type_argument");
        Token (Literal ":>");
        Token (Name "type");
      ];
      Seq [
        Token (Name "imm_tok_hash");
        Token (Name "type");
      ];
    |];
  );
  "type_argument_constraints",
  Some (
    Seq [
      Token (Literal "when");
      Token (Name "constraint");
      Repeat (
        Seq [
          Token (Literal "and");
          Token (Name "constraint");
        ];
      );
    ];
  );
  "type_argument_defn",
  Some (
    Seq [
      Opt (
        Token (Name "attributes");
      );
      Token (Name "type_argument");
    ];
  );
  "type_arguments",
  Some (
    Seq [
      Token (Literal "<");
      Token (Name "type_argument_defn");
      Repeat (
        Seq [
          Token (Literal ",");
          Token (Name "type_argument_defn");
        ];
      );
      Opt (
        Token (Name "type_argument_constraints");
      );
      Token (Literal ">");
    ];
  );
  "type_attribute",
  Some (
    Alt [|
      Token (Name "type");
    |];
  );
  "type_attributes",
  Some (
    Seq [
      Token (Name "type_attribute");
      Repeat (
        Seq [
          Token (Literal ",");
          Token (Name "type_attribute");
        ];
      );
    ];
  );
  "typecast_expression",
  Some (
    Seq [
      Token (Name "expression_inner");
      Alt [|
        Token (Literal ":");
        Token (Literal ":>");
        Token (Literal ":?");
        Token (Literal ":?>");
      |];
      Token (Name "type");
    ];
  );
  "typed_expression",
  Some (
    Seq [
      Token (Name "expression_inner");
      Token (Name "imm_tok_lt");
      Opt (
        Token (Name "types");
      );
      Token (Literal ">");
    ];
  );
  "typed_pattern",
  Some (
    Seq [
      Token (Name "pattern");
      Token (Literal ":");
      Token (Name "type");
    ];
  );
  "types",
  Some (
    Seq [
      Token (Name "type");
      Repeat1 (
        Seq [
          Token (Literal ",");
          Token (Name "type");
        ];
      );
    ];
  );
  "value_declaration_left",
  Some (
    Seq [
      Opt (
        Token (Literal "mutable");
      );
      Opt (
        Alt [|
          Token (Literal "private");
          Token (Literal "internal");
          Token (Literal "public");
        |];
      );
      Token (Name "pattern");
      Opt (
        Token (Name "type_arguments");
      );
      Opt (
        Seq [
          Token (Literal ":");
          Token (Name "type");
        ];
      );
    ];
  );
  "while_expression",
  Some (
    Seq [
      Token (Literal "while");
      Token (Name "expression_inner");
      Token (Literal "do");
      Token (Name "virtual_open_section");
      Token (Name "expressions");
      Token (Name "virtual_end_section");
      Opt (
        Token (Literal "done");
      );
    ];
  );
  "with_field_expression",
  Some (
    Seq [
      Token (Name "expressions");
      Token (Literal "with");
      Token (Name "virtual_open_section");
      Token (Name "field_initializers");
      Token (Name "virtual_end_section");
    ];
  );
  "yield_expression",
  Some (
    Seq [
      Alt [|
        Token (Literal "yield");
        Token (Literal "yield!");
      |];
      Token (Name "expression_inner");
    ];
  );
  "enum_type_cases",
  Some (
    Seq [
      Opt (
        Token (Literal "|");
      );
      Token (Name "enum_type_case");
      Repeat (
        Seq [
          Token (Name "virtual_end_decl");
          Token (Literal "|");
          Token (Name "enum_type_case");
        ];
      );
    ];
  );
  "union_type_field",
  Some (
    Alt [|
      Token (Name "type");
      Seq [
        Token (Name "identifier");
        Token (Literal ":");
        Token (Name "type");
      ];
    |];
  );
  "class_inherits_decl",
  Some (
    Seq [
      Token (Literal "inherit");
      Token (Name "type");
      Token (Name "virtual_open_section");
      Opt (
        Token (Name "expressions");
      );
      Token (Name "virtual_end_section");
    ];
  );
  "type_name",
  Some (
    Seq [
      Opt (
        Token (Name "attributes");
      );
      Opt (
        Alt [|
          Token (Literal "private");
          Token (Literal "internal");
          Token (Literal "public");
        |];
      );
      Alt [|
        Seq [
          Token (Name "identifier");
          Opt (
            Token (Name "type_arguments");
          );
        ];
        Seq [
          Opt (
            Token (Name "type_argument");
          );
          Token (Name "identifier");
        ];
      |];
    ];
  );
  "do",
  Some (
    Seq [
      Token (Literal "do");
      Token (Name "virtual_open_section");
      Token (Name "expressions");
      Token (Name "virtual_end_section");
    ];
  );
  "simple_pattern",
  Some (
    Alt [|
      Token (Name "identifier");
      Seq [
        Token (Name "simple_pattern");
        Token (Literal ":");
        Token (Name "type");
      ];
    |];
  );
  "type_defn_elements",
  Some (
    Alt [|
      Token (Name "member_defns");
      Token (Name "interface_implementations");
    |];
  );
  "record_field",
  Some (
    Seq [
      Opt (
        Token (Name "attributes");
      );
      Opt (
        Token (Literal "mutable");
      );
      Opt (
        Alt [|
          Token (Literal "private");
          Token (Literal "internal");
          Token (Literal "public");
        |];
      );
      Token (Name "identifier");
      Token (Literal ":");
      Token (Name "type");
    ];
  );
  "class_function_or_value_defn",
  Some (
    Seq [
      Opt (
        Token (Name "attributes");
      );
      Opt (
        Token (Literal "static");
      );
      Alt [|
        Token (Name "function_or_value_defn");
        Seq [
          Token (Literal "do");
          Token (Name "virtual_open_section");
          Token (Name "expressions");
          Token (Name "virtual_end_section");
        ];
      |];
    ];
  );
  "delegate_signature",
  Some (
    Seq [
      Token (Literal "delegate");
      Token (Literal "of");
      Token (Name "type");
    ];
  );
  "union_type_fields",
  Some (
    Seq [
      Token (Name "union_type_field");
      Repeat (
        Seq [
          Token (Literal "*");
          Token (Name "union_type_field");
        ];
      );
    ];
  );
  "type_abbrev_defn",
  Some (
    Seq [
      Token (Name "type_name");
      Token (Literal "=");
      Token (Name "virtual_open_section");
      Token (Name "type");
      Token (Name "virtual_end_section");
    ];
  );
  "enum_type_defn",
  Some (
    Seq [
      Token (Name "type_name");
      Token (Literal "=");
      Token (Name "virtual_open_section");
      Token (Name "enum_type_cases");
      Token (Name "virtual_end_section");
    ];
  );
  "value_declaration",
  Some (
    Alt [|
      Token (Name "function_or_value_defn");
      Token (Name "do");
    |];
  );
  "primary_constr_args",
  Some (
    Seq [
      Opt (
        Token (Name "attributes");
      );
      Opt (
        Alt [|
          Token (Literal "private");
          Token (Literal "internal");
          Token (Literal "public");
        |];
      );
      Token (Literal "(");
      Opt (
        Seq [
          Token (Name "simple_pattern");
          Repeat (
            Seq [
              Token (Literal ",");
              Token (Name "simple_pattern");
            ];
          );
        ];
      );
      Token (Literal ")");
    ];
  );
  "type_extension_elements",
  Some (
    Seq [
      Alt [|
        Seq [
          Token (Literal "with");
          Token (Name "virtual_open_section");
          Token (Name "type_defn_elements");
          Token (Name "virtual_end_section");
        ];
        Token (Name "type_defn_elements");
      |];
    ];
  );
  "record_fields",
  Some (
    Seq [
      Token (Name "record_field");
      Repeat (
        Seq [
          Token (Name "virtual_end_decl");
          Token (Name "record_field");
        ];
      );
      Opt (
        Token (Literal ";");
      );
    ];
  );
  "class_type_body_inner",
  Some (
    Alt [|
      Token (Name "class_inherits_decl");
      Token (Name "class_function_or_value_defn");
      Token (Name "type_defn_elements");
    |];
  );
  "delegate_type_defn",
  Some (
    Seq [
      Token (Name "type_name");
      Token (Literal "=");
      Token (Name "virtual_open_section");
      Token (Name "delegate_signature");
      Token (Name "virtual_end_section");
    ];
  );
  "union_type_case",
  Some (
    Seq [
      Opt (
        Token (Name "attributes");
      );
      Alt [|
        Token (Name "identifier");
        Seq [
          Token (Name "identifier");
          Token (Literal "of");
          Token (Name "union_type_fields");
        ];
        Seq [
          Token (Name "identifier");
          Token (Literal ":");
          Token (Name "type");
        ];
      |];
    ];
  );
  "type_extension",
  Some (
    Seq [
      Token (Name "type_name");
      Token (Name "type_extension_elements");
    ];
  );
  "record_type_defn",
  Some (
    Seq [
      Token (Name "type_name");
      Token (Literal "=");
      Token (Name "virtual_open_section");
      Token (Literal "{");
      Token (Name "virtual_open_section");
      Token (Name "record_fields");
      Token (Name "virtual_end_section");
      Token (Literal "}");
      Opt (
        Token (Name "type_extension_elements");
      );
      Token (Name "virtual_end_section");
    ];
  );
  "class_type_body",
  Some (
    Seq [
      Token (Name "virtual_open_section");
      Token (Name "class_type_body_inner");
      Repeat (
        Seq [
          Token (Name "virtual_end_decl");
          Token (Name "class_type_body_inner");
        ];
      );
      Token (Name "virtual_end_section");
    ];
  );
  "union_type_cases",
  Some (
    Seq [
      Opt (
        Token (Literal "|");
      );
      Token (Name "union_type_case");
      Repeat (
        Seq [
          Token (Literal "|");
          Token (Name "union_type_case");
        ];
      );
    ];
  );
  "anon_type_defn",
  Some (
    Seq [
      Token (Name "type_name");
      Token (Name "primary_constr_args");
      Token (Literal "=");
      Token (Name "virtual_open_section");
      Token (Name "class_type_body");
      Token (Name "virtual_end_section");
    ];
  );
  "union_type_defn",
  Some (
    Seq [
      Token (Name "type_name");
      Token (Literal "=");
      Token (Name "virtual_open_section");
      Token (Name "union_type_cases");
      Opt (
        Token (Name "type_extension_elements");
      );
      Token (Name "virtual_end_section");
    ];
  );
  "type_defn_body",
  Some (
    Alt [|
      Token (Name "delegate_type_defn");
      Token (Name "record_type_defn");
      Token (Name "union_type_defn");
      Token (Name "anon_type_defn");
      Token (Name "enum_type_defn");
      Token (Name "type_abbrev_defn");
      Token (Name "type_extension");
    |];
  );
  "type_definition",
  Some (
    Seq [
      Opt (
        Token (Name "attributes");
      );
      Token (Literal "type");
      Token (Name "type_defn_body");
      Repeat (
        Seq [
          Opt (
            Token (Name "attributes");
          );
          Token (Literal "and");
          Token (Name "type_defn_body");
        ];
      );
    ];
  );
  "module_defn",
  Some (
    Seq [
      Opt (
        Token (Name "attributes");
      );
      Token (Literal "module");
      Opt (
        Alt [|
          Token (Literal "private");
          Token (Literal "internal");
          Token (Literal "public");
        |];
      );
      Token (Name "identifier");
      Token (Literal "=");
      Token (Name "virtual_open_section");
      Repeat1 (
        Alt [|
          Token (Name "block_comment");
          Token (Name "line_comment");
          Token (Name "value_declaration");
          Token (Name "module_defn");
          Token (Name "module_abbrev");
          Token (Name "import_decl");
          Token (Name "compiler_directive_decl");
          Token (Name "fsi_directive_decl");
          Token (Name "type_definition");
        |];
      );
      Token (Name "virtual_end_section");
    ];
  );
  "named_module",
  Some (
    Seq [
      Token (Literal "module");
      Opt (
        Alt [|
          Token (Literal "private");
          Token (Literal "internal");
          Token (Literal "public");
        |];
      );
      Token (Name "long_identifier");
      Repeat (
        Alt [|
          Token (Name "block_comment");
          Token (Name "line_comment");
          Token (Name "value_declaration");
          Token (Name "module_defn");
          Token (Name "module_abbrev");
          Token (Name "import_decl");
          Token (Name "compiler_directive_decl");
          Token (Name "fsi_directive_decl");
          Token (Name "type_definition");
        |];
      );
    ];
  );
  "namespace",
  Some (
    Seq [
      Token (Literal "namespace");
      Alt [|
        Token (Literal "global");
        Token (Name "long_identifier");
      |];
      Repeat (
        Alt [|
          Token (Name "block_comment");
          Token (Name "line_comment");
          Token (Name "value_declaration");
          Token (Name "module_defn");
          Token (Name "module_abbrev");
          Token (Name "import_decl");
          Token (Name "compiler_directive_decl");
          Token (Name "fsi_directive_decl");
          Token (Name "type_definition");
        |];
      );
    ];
  );
  "file",
  Some (
    Alt [|
      Token (Name "named_module");
      Token (Name "namespace");
      Repeat1 (
        Alt [|
          Token (Name "block_comment");
          Token (Name "line_comment");
          Token (Name "value_declaration");
          Token (Name "module_defn");
          Token (Name "module_abbrev");
          Token (Name "import_decl");
          Token (Name "compiler_directive_decl");
          Token (Name "fsi_directive_decl");
          Token (Name "type_definition");
        |];
      );
    |];
  );
]

let trans_imm_tok_choice_ul_ ((kind, body) : mt) : CST.imm_tok_choice_ul_ =
  match body with
  | Leaf v -> v
  | Children _ -> assert false


let trans_imm_tok_choice_ul ((kind, body) : mt) : CST.imm_tok_choice_ul =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_dquot ((kind, body) : mt) : CST.imm_tok_dquot =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_lpar ((kind, body) : mt) : CST.imm_tok_lpar =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_pat_c3eb998 ((kind, body) : mt) : CST.pat_c3eb998 =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_bitdigit_imm ((kind, body) : mt) : CST.bitdigit_imm =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_hash ((kind, body) : mt) : CST.imm_tok_hash =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_digit_char_imm ((kind, body) : mt) : CST.digit_char_imm =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_pat_9d988a2 ((kind, body) : mt) : CST.pat_9d988a2 =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_squot ((kind, body) : mt) : CST.imm_tok_squot =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_virtual_end_decl ((kind, body) : mt) : CST.virtual_end_decl =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_pat_0257738 ((kind, body) : mt) : CST.pat_0257738 =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_dquotdquotdquot ((kind, body) : mt) : CST.imm_tok_dquotdquotdquot =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_simple_string_char ((kind, body) : mt) : CST.simple_string_char =
  match body with
  | Leaf v -> v
  | Children _ -> assert false


let trans_imm_tok_squotb ((kind, body) : mt) : CST.imm_tok_squotb =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_block_comment_content ((kind, body) : mt) : CST.block_comment_content =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_octaldigit_imm ((kind, body) : mt) : CST.octaldigit_imm =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_range_op_name ((kind, body) : mt) : CST.range_op_name =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `DOTDOT (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `DOTDOTSPACEDOTDOT (
            Run.trans_token (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_escape_char ((kind, body) : mt) : CST.escape_char =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_l ((kind, body) : mt) : CST.imm_tok_l =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_s ((kind, body) : mt) : CST.imm_tok_s =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_pat_213dc3e ((kind, body) : mt) : CST.pat_213dc3e =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_pat_0o ((kind, body) : mt) : CST.pat_0o =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_attribute_target ((kind, body) : mt) : CST.attribute_target =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Asse (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Module (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `Ret (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (3, v) ->
          `Field (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (4, v) ->
          `Prop (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (5, v) ->
          `Param (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (6, v) ->
          `Type (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (7, v) ->
          `Cons (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (8, v) ->
          `Event (
            Run.trans_token (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_imm_tok_lt ((kind, body) : mt) : CST.imm_tok_lt =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_dot ((kind, body) : mt) : CST.imm_tok_dot =
  match body with
  | Leaf v -> v
  | Children _ -> assert false


let trans_imm_tok_pat_m ((kind, body) : mt) : CST.imm_tok_pat_m =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_f ((kind, body) : mt) : CST.imm_tok_f =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_lf ((kind, body) : mt) : CST.imm_tok_lf =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_lbrack ((kind, body) : mt) : CST.imm_tok_lbrack =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_virtual_open_section ((kind, body) : mt) : CST.virtual_open_section =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_lf_ ((kind, body) : mt) : CST.imm_tok_lf_ =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_l_ ((kind, body) : mt) : CST.imm_tok_l_ =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_y ((kind, body) : mt) : CST.imm_tok_y =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_bslashu ((kind, body) : mt) : CST.imm_tok_bslashu =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_un ((kind, body) : mt) : CST.imm_tok_un =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_dquotb ((kind, body) : mt) : CST.imm_tok_dquotb =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_pat_35b22f4 ((kind, body) : mt) : CST.imm_tok_pat_35b22f4 =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_bslash ((kind, body) : mt) : CST.imm_tok_bslash =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_uy ((kind, body) : mt) : CST.imm_tok_uy =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_pat_0b ((kind, body) : mt) : CST.pat_0b =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_us ((kind, body) : mt) : CST.imm_tok_us =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_pat_0x ((kind, body) : mt) : CST.pat_0x =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_n ((kind, body) : mt) : CST.imm_tok_n =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_non_escape_char ((kind, body) : mt) : CST.non_escape_char =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_hex_digit_imm ((kind, body) : mt) : CST.hex_digit_imm =
  match body with
  | Leaf v -> v
  | Children _ -> assert false


let trans_simple_char_char ((kind, body) : mt) : CST.simple_char_char =
  match body with
  | Leaf v -> v
  | Children _ -> assert false


let trans_imm_tok_bsla ((kind, body) : mt) : CST.imm_tok_bsla =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_virtual_end_section ((kind, body) : mt) : CST.virtual_end_section =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_float_ ((kind, body) : mt) : CST.float_ =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_imm_tok_pat_684220d ((kind, body) : mt) : CST.imm_tok_pat_684220d =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_line_comment ((kind, body) : mt) : CST.line_comment =
  match body with
  | Leaf v -> v
  | Children _ -> assert false

let trans_identifier ((kind, body) : mt) : CST.identifier =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Pat_c3eb998 (
            trans_pat_c3eb998 (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Pat_9d988a2 (
            trans_pat_9d988a2 (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_symbolic_op ((kind, body) : mt) : CST.symbolic_op =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `QMARK (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `QMARKLTDASH (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `Pat_0257738 (
            trans_pat_0257738 (Run.matcher_token v)
          )
      | Alt (3, v) ->
          `Choice_LTAT (
            (match v with
            | Alt (0, v) ->
                `LTAT (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `LTATAT (
                  Run.trans_token (Run.matcher_token v)
                )
            | _ -> assert false
            )
          )
      | Alt (4, v) ->
          `Choice_ATGT (
            (match v with
            | Alt (0, v) ->
                `ATGT (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `ATATGT (
                  Run.trans_token (Run.matcher_token v)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_block_comment ((kind, body) : mt) : CST.block_comment =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_block_comment_content (Run.matcher_token v1),
            Run.trans_token (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_int_ ((kind, body) : mt) : CST.int_ =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_pat_213dc3e (Run.matcher_token v0),
            Run.repeat
              (fun v -> trans_digit_char_imm (Run.matcher_token v))
              v1
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_trigraph ((kind, body) : mt) : CST.trigraph =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            trans_imm_tok_bslash (Run.matcher_token v0),
            trans_digit_char_imm (Run.matcher_token v1),
            trans_digit_char_imm (Run.matcher_token v2),
            trans_digit_char_imm (Run.matcher_token v3)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_verbatim_string_char ((kind, body) : mt) : CST.verbatim_string_char =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Simple_str_char (
            trans_simple_string_char (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Non_esc_char (
            trans_non_escape_char (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `BSLASH (
            Run.trans_token (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_unicodegraph_long ((kind, body) : mt) : CST.unicodegraph_long =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5; v6; v7; v8] ->
          (
            trans_imm_tok_bslashu (Run.matcher_token v0),
            trans_hex_digit_imm (Run.matcher_token v1),
            trans_hex_digit_imm (Run.matcher_token v2),
            trans_hex_digit_imm (Run.matcher_token v3),
            trans_hex_digit_imm (Run.matcher_token v4),
            trans_hex_digit_imm (Run.matcher_token v5),
            trans_hex_digit_imm (Run.matcher_token v6),
            trans_hex_digit_imm (Run.matcher_token v7),
            trans_hex_digit_imm (Run.matcher_token v8)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_xint ((kind, body) : mt) : CST.xint =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Pat_0x_rep1_hex_digit_imm (
            (match v with
            | Seq [v0; v1] ->
                (
                  trans_pat_0x (Run.matcher_token v0),
                  Run.repeat1
                    (fun v -> trans_hex_digit_imm (Run.matcher_token v))
                    v1
                )
            | _ -> assert false
            )
          )
      | Alt (1, v) ->
          `Pat_0o_rep1_octa_imm (
            (match v with
            | Seq [v0; v1] ->
                (
                  trans_pat_0o (Run.matcher_token v0),
                  Run.repeat1
                    (fun v -> trans_octaldigit_imm (Run.matcher_token v))
                    v1
                )
            | _ -> assert false
            )
          )
      | Alt (2, v) ->
          `Pat_0b_rep1_bitd_imm (
            (match v with
            | Seq [v0; v1] ->
                (
                  trans_pat_0b (Run.matcher_token v0),
                  Run.repeat1
                    (fun v -> trans_bitdigit_imm (Run.matcher_token v))
                    v1
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_unicodegraph_short ((kind, body) : mt) : CST.unicodegraph_short =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            trans_imm_tok_bsla (Run.matcher_token v0),
            trans_hex_digit_imm (Run.matcher_token v1),
            trans_hex_digit_imm (Run.matcher_token v2),
            trans_hex_digit_imm (Run.matcher_token v3),
            trans_hex_digit_imm (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_unit_ ((kind, body) : mt) : CST.unit_ =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            Run.opt
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      trans_virtual_open_section (Run.matcher_token v0),
                      trans_virtual_end_section (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v1
            ,
            Run.trans_token (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_simple_or_escape_char ((kind, body) : mt) : CST.simple_or_escape_char =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Esc_char (
            trans_escape_char (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Imm_tok_pat_684220d (
            trans_imm_tok_pat_684220d (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_type_argument ((kind, body) : mt) : CST.type_argument =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `X__ (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `SQUOT_id (
            (match v with
            | Seq [v0; v1] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  trans_identifier (Run.matcher_token v1)
                )
            | _ -> assert false
            )
          )
      | Alt (2, v) ->
          `HAT_id (
            (match v with
            | Seq [v0; v1] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  trans_identifier (Run.matcher_token v1)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_property_or_ident ((kind, body) : mt) : CST.property_or_ident =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Id_DOT_id (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  trans_identifier (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  trans_identifier (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | Alt (1, v) ->
          `Id (
            trans_identifier (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_static_type_argument ((kind, body) : mt) : CST.static_type_argument =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Choice_HAT_id (
            (match v with
            | Seq [v0; v1] ->
                (
                  (match v0 with
                  | Alt (0, v) ->
                      `HAT (
                        Run.trans_token (Run.matcher_token v)
                      )
                  | Alt (1, v) ->
                      `SQUOT (
                        Run.trans_token (Run.matcher_token v)
                      )
                  | _ -> assert false
                  )
                  ,
                  trans_identifier (Run.matcher_token v1)
                )
            | _ -> assert false
            )
          )
      | Alt (1, v) ->
          `Choice_HAT_id_rep_or_choice_HAT_id (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  (match v0 with
                  | Alt (0, v) ->
                      `HAT (
                        Run.trans_token (Run.matcher_token v)
                      )
                  | Alt (1, v) ->
                      `SQUOT (
                        Run.trans_token (Run.matcher_token v)
                      )
                  | _ -> assert false
                  )
                  ,
                  trans_identifier (Run.matcher_token v1),
                  Run.repeat
                    (fun v ->
                      (match v with
                      | Seq [v0; v1; v2] ->
                          (
                            Run.trans_token (Run.matcher_token v0),
                            (match v1 with
                            | Alt (0, v) ->
                                `HAT (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | Alt (1, v) ->
                                `SQUOT (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | _ -> assert false
                            )
                            ,
                            trans_identifier (Run.matcher_token v2)
                          )
                      | _ -> assert false
                      )
                    )
                    v2
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_active_pattern_op_name ((kind, body) : mt) : CST.active_pattern_op_name =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `BAR_id_rep1_BAR_id_BAR (
            (match v with
            | Seq [v0; v1; v2; v3] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  trans_identifier (Run.matcher_token v1),
                  Run.repeat1
                    (fun v ->
                      (match v with
                      | Seq [v0; v1] ->
                          (
                            Run.trans_token (Run.matcher_token v0),
                            trans_identifier (Run.matcher_token v1)
                          )
                      | _ -> assert false
                      )
                    )
                    v2
                  ,
                  Run.trans_token (Run.matcher_token v3)
                )
            | _ -> assert false
            )
          )
      | Alt (1, v) ->
          `BAR_id_rep_BAR_id_BAR___BAR (
            (match v with
            | Seq [v0; v1; v2; v3; v4; v5] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  trans_identifier (Run.matcher_token v1),
                  Run.repeat
                    (fun v ->
                      (match v with
                      | Seq [v0; v1] ->
                          (
                            Run.trans_token (Run.matcher_token v0),
                            trans_identifier (Run.matcher_token v1)
                          )
                      | _ -> assert false
                      )
                    )
                    v2
                  ,
                  Run.trans_token (Run.matcher_token v3),
                  Run.trans_token (Run.matcher_token v4),
                  Run.trans_token (Run.matcher_token v5)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_as_defn ((kind, body) : mt) : CST.as_defn =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_identifier (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false


let trans_long_identifier ((kind, body) : mt) : CST.long_identifier =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_identifier (Run.matcher_token v0),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_identifier (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v1
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_prefix_op ((kind, body) : mt) : CST.prefix_op =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Choice_PLUS (
            (match v with
            | Alt (0, v) ->
                `PLUS (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `DASH (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (2, v) ->
                `PLUSDOT (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (3, v) ->
                `DASHDOT (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (4, v) ->
                `PERC (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (5, v) ->
                `AMP (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (6, v) ->
                `AMPAMP (
                  Run.trans_token (Run.matcher_token v)
                )
            | _ -> assert false
            )
          )
      | Alt (1, v) ->
          `Rep1_TILDE (
            Run.repeat1
              (fun v -> Run.trans_token (Run.matcher_token v))
              v
          )
      | Alt (2, v) ->
          `Symb_op (
            trans_symbolic_op (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_infix_op ((kind, body) : mt) : CST.infix_op =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Choice_PLUS (
            (match v with
            | Alt (0, v) ->
                `PLUS (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `DASH (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (2, v) ->
                `PLUSDOT (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (3, v) ->
                `DASHDOT (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (4, v) ->
                `PERC (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (5, v) ->
                `AMP (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (6, v) ->
                `AMPAMP (
                  Run.trans_token (Run.matcher_token v)
                )
            | _ -> assert false
            )
          )
      | Alt (1, v) ->
          `Symb_op (
            trans_symbolic_op (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `BARBAR (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (3, v) ->
          `EQ (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (4, v) ->
          `BANGEQ (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (5, v) ->
          `COLONEQ (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (6, v) ->
          `COLONCOLON (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (7, v) ->
          `DOLLAR (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (8, v) ->
          `Or (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (9, v) ->
          `QMARK (
            Run.trans_token (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_bignum ((kind, body) : mt) : CST.bignum =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_int_ (Run.matcher_token v0),
            trans_imm_tok_pat_35b22f4 (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_decimal ((kind, body) : mt) : CST.decimal =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Float (
                  trans_float_ (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Int (
                  trans_int_ (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_imm_tok_pat_m (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_verbatim_string ((kind, body) : mt) : CST.verbatim_string =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            Run.repeat
              (fun v -> trans_verbatim_string_char (Run.matcher_token v))
              v1
            ,
            trans_imm_tok_dquot (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_verbatim_bytearray ((kind, body) : mt) : CST.verbatim_bytearray =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            Run.repeat
              (fun v -> trans_verbatim_string_char (Run.matcher_token v))
              v1
            ,
            trans_imm_tok_dquotb (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_int32 ((kind, body) : mt) : CST.int32 =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Int (
                  trans_int_ (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Xint (
                  trans_xint (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_imm_tok_l (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_int16 ((kind, body) : mt) : CST.int16 =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Int (
                  trans_int_ (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Xint (
                  trans_xint (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_imm_tok_s (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_ieee64 ((kind, body) : mt) : CST.ieee64 =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_xint (Run.matcher_token v0),
            trans_imm_tok_lf_ (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_int64 ((kind, body) : mt) : CST.int64 =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Int (
                  trans_int_ (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Xint (
                  trans_xint (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_imm_tok_l_ (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_byte ((kind, body) : mt) : CST.byte =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Int (
                  trans_int_ (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Xint (
                  trans_xint (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_imm_tok_uy (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_uint32 ((kind, body) : mt) : CST.uint32 =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Int (
                  trans_int_ (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Xint (
                  trans_xint (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_imm_tok_choice_ul (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_sbyte ((kind, body) : mt) : CST.sbyte =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Int (
                  trans_int_ (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Xint (
                  trans_xint (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_imm_tok_y (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_uint64 ((kind, body) : mt) : CST.uint64 =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Int (
                  trans_int_ (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Xint (
                  trans_xint (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_imm_tok_choice_ul_ (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_unativeint ((kind, body) : mt) : CST.unativeint =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Int (
                  trans_int_ (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Xint (
                  trans_xint (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_imm_tok_un (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_ieee32 ((kind, body) : mt) : CST.ieee32 =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Float_imm_tok_f (
            (match v with
            | Seq [v0; v1] ->
                (
                  trans_float_ (Run.matcher_token v0),
                  trans_imm_tok_f (Run.matcher_token v1)
                )
            | _ -> assert false
            )
          )
      | Alt (1, v) ->
          `Xint_imm_tok_lf (
            (match v with
            | Seq [v0; v1] ->
                (
                  trans_xint (Run.matcher_token v0),
                  trans_imm_tok_lf (Run.matcher_token v1)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_nativeint ((kind, body) : mt) : CST.nativeint =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Int (
                  trans_int_ (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Xint (
                  trans_xint (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_imm_tok_n (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_uint16 ((kind, body) : mt) : CST.uint16 =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Int (
                  trans_int_ (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Xint (
                  trans_xint (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_imm_tok_us (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_char_char ((kind, body) : mt) : CST.char_char =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Simple_char_char (
            trans_simple_char_char (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Esc_char (
            trans_escape_char (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `Trig (
            trans_trigraph (Run.matcher_token v)
          )
      | Alt (3, v) ->
          `Unic_short (
            trans_unicodegraph_short (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_string_char ((kind, body) : mt) : CST.string_char =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Simple_str_char (
            trans_simple_string_char (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Esc_char (
            trans_escape_char (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `Non_esc_char (
            trans_non_escape_char (Run.matcher_token v)
          )
      | Alt (3, v) ->
          `Trig (
            trans_trigraph (Run.matcher_token v)
          )
      | Alt (4, v) ->
          `Unic_short (
            trans_unicodegraph_short (Run.matcher_token v)
          )
      | Alt (5, v) ->
          `Unic_long (
            trans_unicodegraph_long (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_triple_quoted_string ((kind, body) : mt) : CST.triple_quoted_string =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            Run.repeat
              (fun v -> trans_simple_or_escape_char (Run.matcher_token v))
              v1
            ,
            trans_imm_tok_dquotdquotdquot (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_op_name ((kind, body) : mt) : CST.op_name =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Symb_op (
            trans_symbolic_op (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Range_op_name (
            trans_range_op_name (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `Active_pat_op_name (
            trans_active_pattern_op_name (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_import_decl ((kind, body) : mt) : CST.import_decl =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_long_identifier (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_module_abbrev ((kind, body) : mt) : CST.module_abbrev =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_identifier (Run.matcher_token v1),
            Run.trans_token (Run.matcher_token v2),
            trans_virtual_open_section (Run.matcher_token v3),
            trans_long_identifier (Run.matcher_token v4),
            trans_virtual_end_section (Run.matcher_token v5)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_bytechar ((kind, body) : mt) : CST.bytechar =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_char_char (Run.matcher_token v1),
            trans_imm_tok_squotb (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_char ((kind, body) : mt) : CST.char =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_char_char (Run.matcher_token v1),
            trans_imm_tok_squot (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_bytearray ((kind, body) : mt) : CST.bytearray =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            Run.repeat
              (fun v -> trans_string_char (Run.matcher_token v))
              v1
            ,
            trans_imm_tok_dquotb (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false


let trans_string_ ((kind, body) : mt) : CST.string_ =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            Run.repeat
              (fun v -> trans_string_char (Run.matcher_token v))
              v1
            ,
            trans_imm_tok_dquot (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_identifier_or_op ((kind, body) : mt) : CST.identifier_or_op =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Id (
            trans_identifier (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `LPAR_op_name_RPAR (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  trans_op_name (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | Alt (2, v) ->
          `LPARSTARRPAR (
            Run.trans_token (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_compiler_directive_decl ((kind, body) : mt) : CST.compiler_directive_decl =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            Run.trans_token (Run.matcher_token v0),
            Run.repeat
              (fun v -> trans_string_ (Run.matcher_token v))
              v1
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_fsi_directive_decl ((kind, body) : mt) : CST.fsi_directive_decl =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `HASHr_rep_str (
            (match v with
            | Seq [v0; v1] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  Run.repeat
                    (fun v -> trans_string_ (Run.matcher_token v))
                    v1
                )
            | _ -> assert false
            )
          )
      | Alt (1, v) ->
          `HASH_rep_str (
            (match v with
            | Seq [v0; v1] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  Run.repeat
                    (fun v -> trans_string_ (Run.matcher_token v))
                    v1
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_const ((kind, body) : mt) : CST.const =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Sbyte (
            trans_sbyte (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Int16 (
            trans_int16 (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `Int32 (
            trans_int32 (Run.matcher_token v)
          )
      | Alt (3, v) ->
          `Int64 (
            trans_int64 (Run.matcher_token v)
          )
      | Alt (4, v) ->
          `Byte_40ea57d (
            trans_byte (Run.matcher_token v)
          )
      | Alt (5, v) ->
          `Uint16 (
            trans_uint16 (Run.matcher_token v)
          )
      | Alt (6, v) ->
          `Uint32 (
            trans_uint32 (Run.matcher_token v)
          )
      | Alt (7, v) ->
          `Int (
            trans_int_ (Run.matcher_token v)
          )
      | Alt (8, v) ->
          `Nati (
            trans_nativeint (Run.matcher_token v)
          )
      | Alt (9, v) ->
          `Unat (
            trans_unativeint (Run.matcher_token v)
          )
      | Alt (10, v) ->
          `Deci (
            trans_decimal (Run.matcher_token v)
          )
      | Alt (11, v) ->
          `Uint64 (
            trans_uint64 (Run.matcher_token v)
          )
      | Alt (12, v) ->
          `Ieee32 (
            trans_ieee32 (Run.matcher_token v)
          )
      | Alt (13, v) ->
          `Ieee64 (
            trans_ieee64 (Run.matcher_token v)
          )
      | Alt (14, v) ->
          `Bignum (
            trans_bignum (Run.matcher_token v)
          )
      | Alt (15, v) ->
          `Char (
            trans_char (Run.matcher_token v)
          )
      | Alt (16, v) ->
          `Str (
            trans_string_ (Run.matcher_token v)
          )
      | Alt (17, v) ->
          `Verb_str (
            trans_verbatim_string (Run.matcher_token v)
          )
      | Alt (18, v) ->
          `Triple_quoted_str (
            trans_triple_quoted_string (Run.matcher_token v)
          )
      | Alt (19, v) ->
          `Byte_575c2e8 (
            trans_bytearray (Run.matcher_token v)
          )
      | Alt (20, v) ->
          `Verb_byte (
            trans_verbatim_bytearray (Run.matcher_token v)
          )
      | Alt (21, v) ->
          `Byte_b1b1cb0 (
            trans_bytechar (Run.matcher_token v)
          )
      | Alt (22, v) ->
          `False (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (23, v) ->
          `True (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (24, v) ->
          `Unit (
            trans_unit_ (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_long_identifier_or_op ((kind, body) : mt) : CST.long_identifier_or_op =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Long_id (
            trans_long_identifier (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Long_id_DOT_id_or_op (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  trans_long_identifier (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  trans_identifier_or_op (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | Alt (2, v) ->
          `Id_or_op (
            trans_identifier_or_op (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_pattern_param ((kind, body) : mt) : CST.pattern_param =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Const (
            trans_const (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Long_id (
            trans_long_identifier (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `Null (
            Run.trans_token (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_enum_type_case ((kind, body) : mt) : CST.enum_type_case =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            trans_identifier (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_const (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let rec trans_additional_constr_defn ((kind, body) : mt) : CST.additional_constr_defn =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            Run.opt
              (fun v ->
                (match v with
                | Alt (0, v) ->
                    `Priv (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (1, v) ->
                    `Inte (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (2, v) ->
                    `Public (
                      Run.trans_token (Run.matcher_token v)
                    )
                | _ -> assert false
                )
              )
              v0
            ,
            Run.trans_token (Run.matcher_token v1),
            trans_pattern (Run.matcher_token v2),
            trans_as_defn (Run.matcher_token v3),
            Run.trans_token (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_application_expression ((kind, body) : mt) : CST.application_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_expression_inner (Run.matcher_token v0),
            Run.repeat1
              (fun v -> trans_expression_inner (Run.matcher_token v))
              v1
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_argument_patterns ((kind, body) : mt) : CST.argument_patterns =
  match body with
  | Children v ->
      Run.repeat1
        (fun v -> trans_atomic_pattern (Run.matcher_token v))
        v
  | Leaf _ -> assert false

and trans_array_expression ((kind, body) : mt) : CST.array_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            Run.opt
              (fun v -> trans_list_element (Run.matcher_token v))
              v1
            ,
            Run.trans_token (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_array_pattern ((kind, body) : mt) : CST.array_pattern =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `LBRACKBAR_BARRBRACK (
            (match v with
            | Seq [v0; v1] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1)
                )
            | _ -> assert false
            )
          )
      | Alt (1, v) ->
          `LBRACKBAR_pat_rep_SEMI_pat_BARRBRACK (
            (match v with
            | Seq [v0; v1; v2; v3] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  trans_pattern (Run.matcher_token v1),
                  Run.repeat
                    (fun v ->
                      (match v with
                      | Seq [v0; v1] ->
                          (
                            Run.trans_token (Run.matcher_token v0),
                            trans_pattern (Run.matcher_token v1)
                          )
                      | _ -> assert false
                      )
                    )
                    v2
                  ,
                  Run.trans_token (Run.matcher_token v3)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_as_pattern ((kind, body) : mt) : CST.as_pattern =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            trans_pattern (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_identifier (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_atomic_pattern ((kind, body) : mt) : CST.atomic_pattern =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Null (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `X__ (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `Const (
            trans_const (Run.matcher_token v)
          )
      | Alt (3, v) ->
          `Long_id (
            trans_long_identifier (Run.matcher_token v)
          )
      | Alt (4, v) ->
          `List_pat (
            trans_list_pattern (Run.matcher_token v)
          )
      | Alt (5, v) ->
          `Record_pat (
            trans_record_pattern (Run.matcher_token v)
          )
      | Alt (6, v) ->
          `Array_pat (
            trans_array_pattern (Run.matcher_token v)
          )
      | Alt (7, v) ->
          `LPAR_virt_open_sect_pat_virt_end_sect_RPAR (
            (match v with
            | Seq [v0; v1; v2; v3; v4] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  trans_virtual_open_section (Run.matcher_token v1),
                  trans_pattern (Run.matcher_token v2),
                  trans_virtual_end_section (Run.matcher_token v3),
                  Run.trans_token (Run.matcher_token v4)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_attribute ((kind, body) : mt) : CST.attribute =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            Run.opt
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      trans_attribute_target (Run.matcher_token v0),
                      Run.trans_token (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v0
            ,
            trans_object_construction (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_attribute_pattern ((kind, body) : mt) : CST.attribute_pattern =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_attributes (Run.matcher_token v0),
            trans_pattern (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_attribute_set ((kind, body) : mt) : CST.attribute_set =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_attribute (Run.matcher_token v1),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_attribute (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v2
            ,
            Run.trans_token (Run.matcher_token v3)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_attributes ((kind, body) : mt) : CST.attributes =
  match body with
  | Children v ->
      Run.repeat1
        (fun v -> trans_attribute_set (Run.matcher_token v))
        v
  | Leaf _ -> assert false

and trans_begin_end_expression ((kind, body) : mt) : CST.begin_end_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_expressions (Run.matcher_token v1),
            Run.trans_token (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_brace_expression ((kind, body) : mt) : CST.brace_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            (match v1 with
            | Alt (0, v) ->
                `With_field_exp (
                  trans_with_field_expression (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Field_exp (
                  trans_field_expression (Run.matcher_token v)
                )
            | Alt (2, v) ->
                `Obj_exp (
                  trans_object_expression (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            Run.trans_token (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_call_expression ((kind, body) : mt) : CST.call_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            trans_expression_inner (Run.matcher_token v0),
            trans_imm_tok_lpar (Run.matcher_token v1),
            Run.opt
              (fun v -> trans_expressions (Run.matcher_token v))
              v2
            ,
            Run.trans_token (Run.matcher_token v3)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_ce_expression ((kind, body) : mt) : CST.ce_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5] ->
          (
            trans_expression_inner (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_virtual_open_section (Run.matcher_token v2),
            trans_comp_or_range_expression (Run.matcher_token v3),
            trans_virtual_end_section (Run.matcher_token v4),
            Run.trans_token (Run.matcher_token v5)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_comp_or_range_expression ((kind, body) : mt) : CST.comp_or_range_expression =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Expres (
            trans_expressions (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Short_comp_exp (
            trans_short_comp_expression (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_conjunct_pattern ((kind, body) : mt) : CST.conjunct_pattern =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            trans_pattern (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_pattern (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_cons_pattern ((kind, body) : mt) : CST.cons_pattern =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            trans_pattern (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_pattern (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_constraint_ ((kind, body) : mt) : CST.constraint_ =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Type_arg_COLONGT_type (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  trans_type_argument (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  trans_type_ (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | Alt (1, v) ->
          `Type_arg_COLON_null (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  trans_type_argument (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | Alt (2, v) ->
          `Static_type_arg_COLON_LPAR_trait_member_cons_RPAR (
            (match v with
            | Seq [v0; v1; v2; v3; v4] ->
                (
                  trans_static_type_argument (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2),
                  trans_trait_member_constraint (Run.matcher_token v3),
                  Run.trans_token (Run.matcher_token v4)
                )
            | _ -> assert false
            )
          )
      | Alt (3, v) ->
          `Type_arg_COLON_LPAR_new_COLON_unit_DASHGT_SQUOTT_RPAR (
            (match v with
            | Seq [v0; v1; v2; v3; v4; v5; v6; v7; v8] ->
                (
                  trans_type_argument (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2),
                  Run.trans_token (Run.matcher_token v3),
                  Run.trans_token (Run.matcher_token v4),
                  Run.trans_token (Run.matcher_token v5),
                  Run.trans_token (Run.matcher_token v6),
                  Run.trans_token (Run.matcher_token v7),
                  Run.trans_token (Run.matcher_token v8)
                )
            | _ -> assert false
            )
          )
      | Alt (4, v) ->
          `Type_arg_COLON_struct (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  trans_type_argument (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | Alt (5, v) ->
          `Type_arg_COLON_not_struct (
            (match v with
            | Seq [v0; v1; v2; v3] ->
                (
                  trans_type_argument (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2),
                  Run.trans_token (Run.matcher_token v3)
                )
            | _ -> assert false
            )
          )
      | Alt (6, v) ->
          `Type_arg_COLON_enum_LT_type_GT (
            (match v with
            | Seq [v0; v1; v2; v3; v4; v5] ->
                (
                  trans_type_argument (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2),
                  Run.trans_token (Run.matcher_token v3),
                  trans_type_ (Run.matcher_token v4),
                  Run.trans_token (Run.matcher_token v5)
                )
            | _ -> assert false
            )
          )
      | Alt (7, v) ->
          `Type_arg_COLON_unma (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  trans_type_argument (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | Alt (8, v) ->
          `Type_arg_COLON_equa (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  trans_type_argument (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | Alt (9, v) ->
          `Type_arg_COLON_comp (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  trans_type_argument (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | Alt (10, v) ->
          `Type_arg_COLON_dele_LT_type_COMMA_type_GT (
            (match v with
            | Seq [v0; v1; v2; v3; v4; v5; v6; v7] ->
                (
                  trans_type_argument (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2),
                  Run.trans_token (Run.matcher_token v3),
                  trans_type_ (Run.matcher_token v4),
                  Run.trans_token (Run.matcher_token v5),
                  trans_type_ (Run.matcher_token v6),
                  Run.trans_token (Run.matcher_token v7)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_declaration_expression ((kind, body) : mt) : CST.declaration_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Choice_use_id_EQ_virt_open_sect_expres_virt_end_sect (
                  (match v with
                  | Seq [v0; v1; v2; v3; v4; v5] ->
                      (
                        (match v0 with
                        | Alt (0, v) ->
                            `Use (
                              Run.trans_token (Run.matcher_token v)
                            )
                        | Alt (1, v) ->
                            `UseB (
                              Run.trans_token (Run.matcher_token v)
                            )
                        | _ -> assert false
                        )
                        ,
                        trans_identifier (Run.matcher_token v1),
                        Run.trans_token (Run.matcher_token v2),
                        trans_virtual_open_section (Run.matcher_token v3),
                        trans_expressions (Run.matcher_token v4),
                        trans_virtual_end_section (Run.matcher_token v5)
                      )
                  | _ -> assert false
                  )
                )
            | Alt (1, v) ->
                `Func_or_value_defn (
                  trans_function_or_value_defn (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_virtual_open_section (Run.matcher_token v1),
            trans_expressions (Run.matcher_token v2),
            trans_virtual_end_section (Run.matcher_token v3)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_disjunct_pattern ((kind, body) : mt) : CST.disjunct_pattern =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            trans_pattern (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_pattern (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_do_expression ((kind, body) : mt) : CST.do_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Do (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `DoBANG (
                  Run.trans_token (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_virtual_open_section (Run.matcher_token v1),
            trans_expressions (Run.matcher_token v2),
            trans_virtual_end_section (Run.matcher_token v3)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_dot_expression ((kind, body) : mt) : CST.dot_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            trans_expression_inner (Run.matcher_token v0),
            trans_imm_tok_dot (Run.matcher_token v1),
            trans_long_identifier_or_op (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_elif_expression ((kind, body) : mt) : CST.elif_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_expression_inner (Run.matcher_token v1),
            Run.trans_token (Run.matcher_token v2),
            trans_virtual_open_section (Run.matcher_token v3),
            trans_expressions (Run.matcher_token v4),
            trans_virtual_end_section (Run.matcher_token v5)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_else_expression ((kind, body) : mt) : CST.else_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_virtual_open_section (Run.matcher_token v1),
            trans_expressions (Run.matcher_token v2),
            trans_virtual_end_section (Run.matcher_token v3)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_expression_inner ((kind, body) : mt) : CST.expression_inner =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Line_comm (
            trans_line_comment (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Blk_comm (
            trans_block_comment (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `Const (
            trans_const (Run.matcher_token v)
          )
      | Alt (3, v) ->
          `Paren_exp (
            trans_paren_expression (Run.matcher_token v)
          )
      | Alt (4, v) ->
          `Begin_end_exp (
            trans_begin_end_expression (Run.matcher_token v)
          )
      | Alt (5, v) ->
          `Long_id_or_op (
            trans_long_identifier_or_op (Run.matcher_token v)
          )
      | Alt (6, v) ->
          `Dot_exp (
            trans_dot_expression (Run.matcher_token v)
          )
      | Alt (7, v) ->
          `Typed_exp (
            trans_typed_expression (Run.matcher_token v)
          )
      | Alt (8, v) ->
          `Infix_exp (
            trans_infix_expression (Run.matcher_token v)
          )
      | Alt (9, v) ->
          `Index_exp (
            trans_index_expression (Run.matcher_token v)
          )
      | Alt (10, v) ->
          `Mutate_exp (
            trans_mutate_expression (Run.matcher_token v)
          )
      | Alt (11, v) ->
          `Obj_inst_exp (
            trans_object_instantiation_expression (Run.matcher_token v)
          )
      | Alt (12, v) ->
          `List_exp (
            trans_list_expression (Run.matcher_token v)
          )
      | Alt (13, v) ->
          `Array_exp (
            trans_array_expression (Run.matcher_token v)
          )
      | Alt (14, v) ->
          `Ce_exp (
            trans_ce_expression (Run.matcher_token v)
          )
      | Alt (15, v) ->
          `Pref_exp (
            trans_prefixed_expression (Run.matcher_token v)
          )
      | Alt (16, v) ->
          `Brace_exp (
            trans_brace_expression (Run.matcher_token v)
          )
      | Alt (17, v) ->
          `Null (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (18, v) ->
          `Type_exp (
            trans_typecast_expression (Run.matcher_token v)
          )
      | Alt (19, v) ->
          `Decl_exp (
            trans_declaration_expression (Run.matcher_token v)
          )
      | Alt (20, v) ->
          `Do_exp (
            trans_do_expression (Run.matcher_token v)
          )
      | Alt (21, v) ->
          `Fun_exp (
            trans_fun_expression (Run.matcher_token v)
          )
      | Alt (22, v) ->
          `Func_exp (
            trans_function_expression (Run.matcher_token v)
          )
      | Alt (23, v) ->
          `If_exp (
            trans_if_expression (Run.matcher_token v)
          )
      | Alt (24, v) ->
          `While_exp (
            trans_while_expression (Run.matcher_token v)
          )
      | Alt (25, v) ->
          `For_exp (
            trans_for_expression (Run.matcher_token v)
          )
      | Alt (26, v) ->
          `Match_exp (
            trans_match_expression (Run.matcher_token v)
          )
      | Alt (27, v) ->
          `Try_exp (
            trans_try_expression (Run.matcher_token v)
          )
      | Alt (28, v) ->
          `Lit_exp (
            trans_literal_expression (Run.matcher_token v)
          )
      | Alt (29, v) ->
          `Call_exp (
            trans_call_expression (Run.matcher_token v)
          )
      | Alt (30, v) ->
          `Tuple_exp (
            trans_tuple_expression (Run.matcher_token v)
          )
      | Alt (31, v) ->
          `App_exp (
            trans_application_expression (Run.matcher_token v)
          )
      | Alt (32, v) ->
          `Ret_exp (
            trans_return_expression (Run.matcher_token v)
          )
      | Alt (33, v) ->
          `Yield_exp (
            trans_yield_expression (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_expressions ((kind, body) : mt) : CST.expressions =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Seq_infix (
            trans_seq_infix (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Exp_inner_rep_virt_end_decl_expres (
            (match v with
            | Seq [v0; v1] ->
                (
                  trans_expression_inner (Run.matcher_token v0),
                  Run.repeat
                    (fun v ->
                      (match v with
                      | Seq [v0; v1] ->
                          (
                            trans_virtual_end_decl (Run.matcher_token v0),
                            trans_expressions (Run.matcher_token v1)
                          )
                      | _ -> assert false
                      )
                    )
                    v1
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_field_expression ((kind, body) : mt) : CST.field_expression =
  match body with
  | Children v ->
      trans_field_initializers (Run.matcher_token v)
  | Leaf _ -> assert false

and trans_field_initializer ((kind, body) : mt) : CST.field_initializer =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            trans_long_identifier (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_virtual_open_section (Run.matcher_token v2),
            trans_expressions (Run.matcher_token v3),
            trans_virtual_end_section (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_field_initializers ((kind, body) : mt) : CST.field_initializers =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_field_initializer (Run.matcher_token v0),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      trans_virtual_end_decl (Run.matcher_token v0),
                      trans_field_initializer (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v1
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_field_pattern ((kind, body) : mt) : CST.field_pattern =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            trans_long_identifier (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_pattern (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_for_expression ((kind, body) : mt) : CST.for_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5; v6] ->
          (
            Run.trans_token (Run.matcher_token v0),
            (match v1 with
            | Alt (0, v) ->
                `Pat_in_choice_exp_inner (
                  (match v with
                  | Seq [v0; v1; v2] ->
                      (
                        trans_pattern (Run.matcher_token v0),
                        Run.trans_token (Run.matcher_token v1),
                        (match v2 with
                        | Alt (0, v) ->
                            `Exp_inner (
                              trans_expression_inner (Run.matcher_token v)
                            )
                        | Alt (1, v) ->
                            `Range_exp (
                              trans_range_expression (Run.matcher_token v)
                            )
                        | _ -> assert false
                        )
                      )
                  | _ -> assert false
                  )
                )
            | Alt (1, v) ->
                `Id_EQ_exp_inner_choice_to_exp_inner (
                  (match v with
                  | Seq [v0; v1; v2; v3; v4] ->
                      (
                        trans_identifier (Run.matcher_token v0),
                        Run.trans_token (Run.matcher_token v1),
                        trans_expression_inner (Run.matcher_token v2),
                        (match v3 with
                        | Alt (0, v) ->
                            `To (
                              Run.trans_token (Run.matcher_token v)
                            )
                        | Alt (1, v) ->
                            `Downto (
                              Run.trans_token (Run.matcher_token v)
                            )
                        | _ -> assert false
                        )
                        ,
                        trans_expression_inner (Run.matcher_token v4)
                      )
                  | _ -> assert false
                  )
                )
            | _ -> assert false
            )
            ,
            Run.trans_token (Run.matcher_token v2),
            trans_virtual_open_section (Run.matcher_token v3),
            trans_expressions (Run.matcher_token v4),
            trans_virtual_end_section (Run.matcher_token v5),
            Run.opt
              (fun v -> Run.trans_token (Run.matcher_token v))
              v6
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_fun_expression ((kind, body) : mt) : CST.fun_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_argument_patterns (Run.matcher_token v1),
            Run.trans_token (Run.matcher_token v2),
            trans_virtual_open_section (Run.matcher_token v3),
            trans_expressions (Run.matcher_token v4),
            trans_virtual_end_section (Run.matcher_token v5)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_function_declaration_left ((kind, body) : mt) : CST.function_declaration_left =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5] ->
          (
            Run.opt
              (fun v -> Run.trans_token (Run.matcher_token v))
              v0
            ,
            Run.opt
              (fun v ->
                (match v with
                | Alt (0, v) ->
                    `Priv (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (1, v) ->
                    `Inte (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (2, v) ->
                    `Public (
                      Run.trans_token (Run.matcher_token v)
                    )
                | _ -> assert false
                )
              )
              v1
            ,
            trans_identifier_or_op (Run.matcher_token v2),
            Run.opt
              (fun v -> trans_type_arguments (Run.matcher_token v))
              v3
            ,
            trans_argument_patterns (Run.matcher_token v4),
            Run.opt
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_type_ (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v5
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_function_expression ((kind, body) : mt) : CST.function_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_rules (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_function_or_value_defn ((kind, body) : mt) : CST.function_or_value_defn =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Let (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `LetB (
                  Run.trans_token (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            (match v1 with
            | Alt (0, v) ->
                `Func_or_value_defn_body (
                  trans_function_or_value_defn_body (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Rec_func_or_value_defns (
                  (match v with
                  | Seq [v0; v1] ->
                      (
                        Run.trans_token (Run.matcher_token v0),
                        trans_function_or_value_defns (Run.matcher_token v1)
                      )
                  | _ -> assert false
                  )
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_function_or_value_defn_body ((kind, body) : mt) : CST.function_or_value_defn_body =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Func_decl_left (
                  trans_function_declaration_left (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Value_decl_left (
                  trans_value_declaration_left (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            Run.trans_token (Run.matcher_token v1),
            trans_virtual_open_section (Run.matcher_token v2),
            trans_expressions (Run.matcher_token v3),
            trans_virtual_end_section (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_function_or_value_defns ((kind, body) : mt) : CST.function_or_value_defns =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_function_or_value_defn_body (Run.matcher_token v0),
            Run.repeat1
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_function_or_value_defn_body (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v1
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_identifier_pattern ((kind, body) : mt) : CST.identifier_pattern =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            trans_long_identifier (Run.matcher_token v0),
            Run.opt
              (fun v -> trans_pattern_param (Run.matcher_token v))
              v1
            ,
            Run.opt
              (fun v -> trans_pattern (Run.matcher_token v))
              v2
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_if_expression ((kind, body) : mt) : CST.if_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_expression_inner (Run.matcher_token v1),
            Run.trans_token (Run.matcher_token v2),
            trans_expressions (Run.matcher_token v3),
            Run.repeat
              (fun v -> trans_elif_expression (Run.matcher_token v))
              v4
            ,
            Run.opt
              (fun v -> trans_else_expression (Run.matcher_token v))
              v5
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_index_expression ((kind, body) : mt) : CST.index_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5; v6] ->
          (
            trans_expression_inner (Run.matcher_token v0),
            Run.opt
              (fun v -> trans_imm_tok_dot (Run.matcher_token v))
              v1
            ,
            trans_imm_tok_lbrack (Run.matcher_token v2),
            trans_virtual_open_section (Run.matcher_token v3),
            (match v4 with
            | Alt (0, v) ->
                `Expres (
                  trans_expressions (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Slice_ranges (
                  trans_slice_ranges (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_virtual_end_section (Run.matcher_token v5),
            Run.trans_token (Run.matcher_token v6)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_infix_expression ((kind, body) : mt) : CST.infix_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            trans_expression_inner (Run.matcher_token v0),
            trans_infix_op (Run.matcher_token v1),
            trans_expression_inner (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_interface_implementation ((kind, body) : mt) : CST.interface_implementation =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_type_ (Run.matcher_token v1),
            Run.opt
              (fun v -> trans_object_members (Run.matcher_token v))
              v2
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_interface_implementations ((kind, body) : mt) : CST.interface_implementations =
  match body with
  | Children v ->
      Run.repeat1
        (fun v ->
          trans_interface_implementation (Run.matcher_token v)
        )
        v
  | Leaf _ -> assert false

and trans_list_element ((kind, body) : mt) : CST.list_element =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `List_elemes (
            trans_list_elements (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Comp_or_range_exp (
            trans_comp_or_range_expression (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_list_elements ((kind, body) : mt) : CST.list_elements =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            trans_virtual_open_section (Run.matcher_token v0),
            trans_expression_inner (Run.matcher_token v1),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      trans_virtual_end_decl (Run.matcher_token v0),
                      trans_expression_inner (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v2
            ,
            trans_virtual_end_section (Run.matcher_token v3)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_list_expression ((kind, body) : mt) : CST.list_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            Run.opt
              (fun v -> trans_list_element (Run.matcher_token v))
              v1
            ,
            Run.trans_token (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_list_pattern ((kind, body) : mt) : CST.list_pattern =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `LBRACK_RBRACK (
            (match v with
            | Seq [v0; v1] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1)
                )
            | _ -> assert false
            )
          )
      | Alt (1, v) ->
          `LBRACK_pat_rep_SEMI_pat_RBRACK (
            (match v with
            | Seq [v0; v1; v2; v3] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  trans_pattern (Run.matcher_token v1),
                  Run.repeat
                    (fun v ->
                      (match v with
                      | Seq [v0; v1] ->
                          (
                            Run.trans_token (Run.matcher_token v0),
                            trans_pattern (Run.matcher_token v1)
                          )
                      | _ -> assert false
                      )
                    )
                    v2
                  ,
                  Run.trans_token (Run.matcher_token v3)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_literal_expression ((kind, body) : mt) : CST.literal_expression =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `LTAT_exp_inner_ATGT (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  trans_expression_inner (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | Alt (1, v) ->
          `LTATAT_exp_inner_ATATGT (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  trans_expression_inner (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_match_expression ((kind, body) : mt) : CST.match_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Match (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Matc (
                  Run.trans_token (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_expression_inner (Run.matcher_token v1),
            Run.trans_token (Run.matcher_token v2),
            trans_rules (Run.matcher_token v3)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_member_defn ((kind, body) : mt) : CST.member_defn =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            Run.opt
              (fun v -> trans_attributes (Run.matcher_token v))
              v0
            ,
            (match v1 with
            | Alt (0, v) ->
                `Opt_static_member_opt_choice_priv_meth_or_prop_defn (
                  (match v with
                  | Seq [v0; v1; v2; v3] ->
                      (
                        Run.opt
                          (fun v -> Run.trans_token (Run.matcher_token v))
                          v0
                        ,
                        Run.trans_token (Run.matcher_token v1),
                        Run.opt
                          (fun v ->
                            (match v with
                            | Alt (0, v) ->
                                `Priv (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | Alt (1, v) ->
                                `Inte (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | Alt (2, v) ->
                                `Public (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | _ -> assert false
                            )
                          )
                          v2
                        ,
                        trans_method_or_prop_defn (Run.matcher_token v3)
                      )
                  | _ -> assert false
                  )
                )
            | Alt (1, v) ->
                `Abst_opt_member_opt_choice_priv_member_sign (
                  (match v with
                  | Seq [v0; v1; v2; v3] ->
                      (
                        Run.trans_token (Run.matcher_token v0),
                        Run.opt
                          (fun v -> Run.trans_token (Run.matcher_token v))
                          v1
                        ,
                        Run.opt
                          (fun v ->
                            (match v with
                            | Alt (0, v) ->
                                `Priv (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | Alt (1, v) ->
                                `Inte (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | Alt (2, v) ->
                                `Public (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | _ -> assert false
                            )
                          )
                          v2
                        ,
                        trans_member_signature (Run.matcher_token v3)
                      )
                  | _ -> assert false
                  )
                )
            | Alt (2, v) ->
                `Over_opt_choice_priv_meth_or_prop_defn (
                  (match v with
                  | Seq [v0; v1; v2] ->
                      (
                        Run.trans_token (Run.matcher_token v0),
                        Run.opt
                          (fun v ->
                            (match v with
                            | Alt (0, v) ->
                                `Priv (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | Alt (1, v) ->
                                `Inte (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | Alt (2, v) ->
                                `Public (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | _ -> assert false
                            )
                          )
                          v1
                        ,
                        trans_method_or_prop_defn (Run.matcher_token v2)
                      )
                  | _ -> assert false
                  )
                )
            | Alt (3, v) ->
                `Defa_opt_choice_priv_meth_or_prop_defn (
                  (match v with
                  | Seq [v0; v1; v2] ->
                      (
                        Run.trans_token (Run.matcher_token v0),
                        Run.opt
                          (fun v ->
                            (match v with
                            | Alt (0, v) ->
                                `Priv (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | Alt (1, v) ->
                                `Inte (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | Alt (2, v) ->
                                `Public (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | _ -> assert false
                            )
                          )
                          v1
                        ,
                        trans_method_or_prop_defn (Run.matcher_token v2)
                      )
                  | _ -> assert false
                  )
                )
            | Alt (4, v) ->
                `Opt_static_val_opt_muta_opt_choice_priv_id_COLON_type (
                  (match v with
                  | Seq [v0; v1; v2; v3; v4; v5; v6] ->
                      (
                        Run.opt
                          (fun v -> Run.trans_token (Run.matcher_token v))
                          v0
                        ,
                        Run.trans_token (Run.matcher_token v1),
                        Run.opt
                          (fun v -> Run.trans_token (Run.matcher_token v))
                          v2
                        ,
                        Run.opt
                          (fun v ->
                            (match v with
                            | Alt (0, v) ->
                                `Priv (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | Alt (1, v) ->
                                `Inte (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | Alt (2, v) ->
                                `Public (
                                  Run.trans_token (Run.matcher_token v)
                                )
                            | _ -> assert false
                            )
                          )
                          v3
                        ,
                        trans_identifier (Run.matcher_token v4),
                        Run.trans_token (Run.matcher_token v5),
                        trans_type_ (Run.matcher_token v6)
                      )
                  | _ -> assert false
                  )
                )
            | Alt (5, v) ->
                `Addi_constr_defn (
                  trans_additional_constr_defn (Run.matcher_token v)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_member_defns ((kind, body) : mt) : CST.member_defns =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_member_defn (Run.matcher_token v0),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      trans_virtual_end_decl (Run.matcher_token v0),
                      trans_member_defn (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v1
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_member_signature ((kind, body) : mt) : CST.member_signature =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            trans_identifier (Run.matcher_token v0),
            Run.opt
              (fun v -> trans_type_arguments (Run.matcher_token v))
              v1
            ,
            Run.trans_token (Run.matcher_token v2),
            trans_type_ (Run.matcher_token v3),
            Run.opt
              (fun v ->
                (match v with
                | Alt (0, v) ->
                    `With_get (
                      (match v with
                      | Seq [v0; v1] ->
                          (
                            Run.trans_token (Run.matcher_token v0),
                            Run.trans_token (Run.matcher_token v1)
                          )
                      | _ -> assert false
                      )
                    )
                | Alt (1, v) ->
                    `With_set (
                      (match v with
                      | Seq [v0; v1] ->
                          (
                            Run.trans_token (Run.matcher_token v0),
                            Run.trans_token (Run.matcher_token v1)
                          )
                      | _ -> assert false
                      )
                    )
                | Alt (2, v) ->
                    `With_get_COMMA_set (
                      (match v with
                      | Seq [v0; v1; v2; v3] ->
                          (
                            Run.trans_token (Run.matcher_token v0),
                            Run.trans_token (Run.matcher_token v1),
                            Run.trans_token (Run.matcher_token v2),
                            Run.trans_token (Run.matcher_token v3)
                          )
                      | _ -> assert false
                      )
                    )
                | Alt (3, v) ->
                    `With_set_COMMA_get (
                      (match v with
                      | Seq [v0; v1; v2; v3] ->
                          (
                            Run.trans_token (Run.matcher_token v0),
                            Run.trans_token (Run.matcher_token v1),
                            Run.trans_token (Run.matcher_token v2),
                            Run.trans_token (Run.matcher_token v3)
                          )
                      | _ -> assert false
                      )
                    )
                | _ -> assert false
                )
              )
              v4
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_method_defn ((kind, body) : mt) : CST.method_defn =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Prop_or_id_pat_EQ_virt_open_sect_expres_virt_end_sect (
            (match v with
            | Seq [v0; v1; v2; v3; v4; v5] ->
                (
                  trans_property_or_ident (Run.matcher_token v0),
                  trans_pattern (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2),
                  trans_virtual_open_section (Run.matcher_token v3),
                  trans_expressions (Run.matcher_token v4),
                  trans_virtual_end_section (Run.matcher_token v5)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_method_or_prop_defn ((kind, body) : mt) : CST.method_or_prop_defn =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Prop_or_id_with_virt_open_sect_func_or_value_defns_virt_end_sect (
            (match v with
            | Seq [v0; v1; v2; v3; v4] ->
                (
                  trans_property_or_ident (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  trans_virtual_open_section (Run.matcher_token v2),
                  trans_function_or_value_defns (Run.matcher_token v3),
                  trans_virtual_end_section (Run.matcher_token v4)
                )
            | _ -> assert false
            )
          )
      | Alt (1, v) ->
          `Meth_defn (
            trans_method_defn (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `Prop_defn (
            trans_property_defn (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_mutate_expression ((kind, body) : mt) : CST.mutate_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            trans_expression_inner (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_expression_inner (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_object_construction ((kind, body) : mt) : CST.object_construction =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_type_ (Run.matcher_token v0),
            Run.opt
              (fun v -> trans_expressions (Run.matcher_token v))
              v1
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_object_expression ((kind, body) : mt) : CST.object_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5] ->
          (
            Run.trans_token (Run.matcher_token v0),
            (match v1 with
            | Alt (0, v) ->
                `Obj_cons (
                  trans_object_construction (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Obj_cons_as_id (
                  (match v with
                  | Seq [v0; v1; v2] ->
                      (
                        trans_object_construction (Run.matcher_token v0),
                        Run.trans_token (Run.matcher_token v1),
                        trans_identifier (Run.matcher_token v2)
                      )
                  | _ -> assert false
                  )
                )
            | _ -> assert false
            )
            ,
            trans_virtual_open_section (Run.matcher_token v2),
            trans_object_members (Run.matcher_token v3),
            trans_interface_implementations (Run.matcher_token v4),
            trans_virtual_end_section (Run.matcher_token v5)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_object_instantiation_expression ((kind, body) : mt) : CST.object_instantiation_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_type_ (Run.matcher_token v1),
            trans_imm_tok_lpar (Run.matcher_token v2),
            trans_expression_inner (Run.matcher_token v3),
            Run.trans_token (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_object_members ((kind, body) : mt) : CST.object_members =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_virtual_open_section (Run.matcher_token v1),
            trans_member_defns (Run.matcher_token v2),
            trans_virtual_end_section (Run.matcher_token v3)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_paren_expression ((kind, body) : mt) : CST.paren_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_virtual_open_section (Run.matcher_token v1),
            trans_expressions (Run.matcher_token v2),
            trans_virtual_end_section (Run.matcher_token v3),
            Run.trans_token (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_paren_pattern ((kind, body) : mt) : CST.paren_pattern =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_virtual_open_section (Run.matcher_token v1),
            trans_pattern (Run.matcher_token v2),
            trans_virtual_end_section (Run.matcher_token v3),
            Run.trans_token (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_pattern ((kind, body) : mt) : CST.pattern =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Null (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `X__ (
            Run.trans_token (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `Const (
            trans_const (Run.matcher_token v)
          )
      | Alt (3, v) ->
          `Id_pat (
            trans_identifier_pattern (Run.matcher_token v)
          )
      | Alt (4, v) ->
          `As_pat (
            trans_as_pattern (Run.matcher_token v)
          )
      | Alt (5, v) ->
          `Disj_pat (
            trans_disjunct_pattern (Run.matcher_token v)
          )
      | Alt (6, v) ->
          `Conj_pat (
            trans_conjunct_pattern (Run.matcher_token v)
          )
      | Alt (7, v) ->
          `Cons_pat (
            trans_cons_pattern (Run.matcher_token v)
          )
      | Alt (8, v) ->
          `Repeat_pat (
            trans_repeat_pattern (Run.matcher_token v)
          )
      | Alt (9, v) ->
          `Paren_pat (
            trans_paren_pattern (Run.matcher_token v)
          )
      | Alt (10, v) ->
          `List_pat (
            trans_list_pattern (Run.matcher_token v)
          )
      | Alt (11, v) ->
          `Array_pat (
            trans_array_pattern (Run.matcher_token v)
          )
      | Alt (12, v) ->
          `Record_pat (
            trans_record_pattern (Run.matcher_token v)
          )
      | Alt (13, v) ->
          `Typed_pat (
            trans_typed_pattern (Run.matcher_token v)
          )
      | Alt (14, v) ->
          `Attr_pat (
            trans_attribute_pattern (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_prefixed_expression ((kind, body) : mt) : CST.prefixed_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Lazy (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Assert (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (2, v) ->
                `Upcast (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (3, v) ->
                `Down (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (4, v) ->
                `PERC (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (5, v) ->
                `PERCPERC (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (6, v) ->
                `Prefix_op (
                  trans_prefix_op (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_expression_inner (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_property_defn ((kind, body) : mt) : CST.property_defn =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5] ->
          (
            trans_property_or_ident (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_virtual_open_section (Run.matcher_token v2),
            trans_expressions (Run.matcher_token v3),
            trans_virtual_end_section (Run.matcher_token v4),
            Run.opt
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      (match v1 with
                      | Alt (0, v) ->
                          `Get (
                            Run.trans_token (Run.matcher_token v)
                          )
                      | Alt (1, v) ->
                          `Set (
                            Run.trans_token (Run.matcher_token v)
                          )
                      | Alt (2, v) ->
                          `Get_COMMA_set (
                            (match v with
                            | Seq [v0; v1; v2] ->
                                (
                                  Run.trans_token (Run.matcher_token v0),
                                  Run.trans_token (Run.matcher_token v1),
                                  Run.trans_token (Run.matcher_token v2)
                                )
                            | _ -> assert false
                            )
                          )
                      | Alt (3, v) ->
                          `Set_COMMA_get (
                            (match v with
                            | Seq [v0; v1; v2] ->
                                (
                                  Run.trans_token (Run.matcher_token v0),
                                  Run.trans_token (Run.matcher_token v1),
                                  Run.trans_token (Run.matcher_token v2)
                                )
                            | _ -> assert false
                            )
                          )
                      | _ -> assert false
                      )
                    )
                | _ -> assert false
                )
              )
              v5
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_range_expression ((kind, body) : mt) : CST.range_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            trans_expressions (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_expressions (Run.matcher_token v2),
            Run.opt
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_expressions (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v3
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_record_pattern ((kind, body) : mt) : CST.record_pattern =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_field_pattern (Run.matcher_token v1),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_field_pattern (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v2
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_repeat_pattern ((kind, body) : mt) : CST.repeat_pattern =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            trans_pattern (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1; v2] ->
                    (
                      trans_virtual_end_decl (Run.matcher_token v0),
                      trans_pattern (Run.matcher_token v1),
                      Run.trans_token (Run.matcher_token v2)
                    )
                | _ -> assert false
                )
              )
              v2
            ,
            trans_pattern (Run.matcher_token v3)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_return_expression ((kind, body) : mt) : CST.return_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Ret (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Retu (
                  Run.trans_token (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_expression_inner (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_rule ((kind, body) : mt) : CST.rule =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            trans_pattern (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_virtual_open_section (Run.matcher_token v2),
            trans_expressions (Run.matcher_token v3),
            trans_virtual_end_section (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_rules ((kind, body) : mt) : CST.rules =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            trans_virtual_open_section (Run.matcher_token v0),
            Run.opt
              (fun v -> Run.trans_token (Run.matcher_token v))
              v1
            ,
            trans_rule (Run.matcher_token v2),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_rule (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v3
            ,
            trans_virtual_end_section (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_seq_infix ((kind, body) : mt) : CST.seq_infix =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_expression_inner (Run.matcher_token v0),
            Run.repeat1
              (fun v ->
                (match v with
                | Seq [v0; v1; v2] ->
                    (
                      trans_virtual_end_decl (Run.matcher_token v0),
                      trans_infix_op (Run.matcher_token v1),
                      trans_expressions (Run.matcher_token v2)
                    )
                | _ -> assert false
                )
              )
              v1
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_short_comp_expression ((kind, body) : mt) : CST.short_comp_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_pattern (Run.matcher_token v1),
            Run.trans_token (Run.matcher_token v2),
            (match v3 with
            | Alt (0, v) ->
                `Exp_inner (
                  trans_expression_inner (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Range_exp (
                  trans_range_expression (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            Run.trans_token (Run.matcher_token v4),
            trans_expressions (Run.matcher_token v5)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_slice_range ((kind, body) : mt) : CST.slice_range =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Slice_range_spec (
            trans_slice_range_special (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Expres (
            trans_expressions (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `STAR (
            Run.trans_token (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_slice_range_special ((kind, body) : mt) : CST.slice_range_special =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Expres_DOTDOT (
            (match v with
            | Seq [v0; v1] ->
                (
                  trans_expressions (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1)
                )
            | _ -> assert false
            )
          )
      | Alt (1, v) ->
          `DOTDOT_expres (
            (match v with
            | Seq [v0; v1] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  trans_expressions (Run.matcher_token v1)
                )
            | _ -> assert false
            )
          )
      | Alt (2, v) ->
          `Expres_DOTDOT_expres (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  trans_expressions (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  trans_expressions (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_slice_ranges ((kind, body) : mt) : CST.slice_ranges =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_slice_range (Run.matcher_token v0),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_slice_range (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v1
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_trait_member_constraint ((kind, body) : mt) : CST.trait_member_constraint =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            Run.opt
              (fun v -> Run.trans_token (Run.matcher_token v))
              v0
            ,
            Run.trans_token (Run.matcher_token v1),
            trans_identifier (Run.matcher_token v2),
            Run.trans_token (Run.matcher_token v3),
            trans_type_ (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_try_expression ((kind, body) : mt) : CST.try_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_virtual_open_section (Run.matcher_token v1),
            trans_expressions (Run.matcher_token v2),
            trans_virtual_end_section (Run.matcher_token v3),
            (match v4 with
            | Alt (0, v) ->
                `With_rules (
                  (match v with
                  | Seq [v0; v1] ->
                      (
                        Run.trans_token (Run.matcher_token v0),
                        trans_rules (Run.matcher_token v1)
                      )
                  | _ -> assert false
                  )
                )
            | Alt (1, v) ->
                `Fina_virt_open_sect_expres_virt_end_sect (
                  (match v with
                  | Seq [v0; v1; v2; v3] ->
                      (
                        Run.trans_token (Run.matcher_token v0),
                        trans_virtual_open_section (Run.matcher_token v1),
                        trans_expressions (Run.matcher_token v2),
                        trans_virtual_end_section (Run.matcher_token v3)
                      )
                  | _ -> assert false
                  )
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_tuple_expression ((kind, body) : mt) : CST.tuple_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_expression_inner (Run.matcher_token v0),
            Run.repeat1
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_expression_inner (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v1
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_type_ ((kind, body) : mt) : CST.type_ =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Long_id (
            trans_long_identifier (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Long_id_LT_opt_type_attris_GT (
            (match v with
            | Seq [v0; v1; v2; v3] ->
                (
                  trans_long_identifier (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  Run.opt
                    (fun v -> trans_type_attributes (Run.matcher_token v))
                    v2
                  ,
                  Run.trans_token (Run.matcher_token v3)
                )
            | _ -> assert false
            )
          )
      | Alt (2, v) ->
          `LPAR_type_RPAR (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  Run.trans_token (Run.matcher_token v0),
                  trans_type_ (Run.matcher_token v1),
                  Run.trans_token (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | Alt (3, v) ->
          `Type_DASHGT_type (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  trans_type_ (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  trans_type_ (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | Alt (4, v) ->
          `Type_rep1_STAR_type (
            (match v with
            | Seq [v0; v1] ->
                (
                  trans_type_ (Run.matcher_token v0),
                  Run.repeat1
                    (fun v ->
                      (match v with
                      | Seq [v0; v1] ->
                          (
                            Run.trans_token (Run.matcher_token v0),
                            trans_type_ (Run.matcher_token v1)
                          )
                      | _ -> assert false
                      )
                    )
                    v1
                )
            | _ -> assert false
            )
          )
      | Alt (5, v) ->
          `Type_long_id (
            (match v with
            | Seq [v0; v1] ->
                (
                  trans_type_ (Run.matcher_token v0),
                  trans_long_identifier (Run.matcher_token v1)
                )
            | _ -> assert false
            )
          )
      | Alt (6, v) ->
          `Type_LBRACK_rep_COMMA_RBRACK (
            (match v with
            | Seq [v0; v1; v2; v3] ->
                (
                  trans_type_ (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  Run.repeat
                    (fun v -> Run.trans_token (Run.matcher_token v))
                    v2
                  ,
                  Run.trans_token (Run.matcher_token v3)
                )
            | _ -> assert false
            )
          )
      | Alt (7, v) ->
          `Type_type_arg_defn (
            (match v with
            | Seq [v0; v1] ->
                (
                  trans_type_ (Run.matcher_token v0),
                  trans_type_argument_defn (Run.matcher_token v1)
                )
            | _ -> assert false
            )
          )
      | Alt (8, v) ->
          `Type_arg (
            trans_type_argument (Run.matcher_token v)
          )
      | Alt (9, v) ->
          `Type_arg_COLONGT_type (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  trans_type_argument (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  trans_type_ (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | Alt (10, v) ->
          `Imm_tok_hash_type (
            (match v with
            | Seq [v0; v1] ->
                (
                  trans_imm_tok_hash (Run.matcher_token v0),
                  trans_type_ (Run.matcher_token v1)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_type_argument_constraints ((kind, body) : mt) : CST.type_argument_constraints =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_constraint_ (Run.matcher_token v1),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_constraint_ (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v2
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_type_argument_defn ((kind, body) : mt) : CST.type_argument_defn =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            Run.opt
              (fun v -> trans_attributes (Run.matcher_token v))
              v0
            ,
            trans_type_argument (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_type_arguments ((kind, body) : mt) : CST.type_arguments =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_type_argument_defn (Run.matcher_token v1),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_type_argument_defn (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v2
            ,
            Run.opt
              (fun v ->
                trans_type_argument_constraints (Run.matcher_token v)
              )
              v3
            ,
            Run.trans_token (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_type_attribute ((kind, body) : mt) : CST.type_attribute =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Type (
            trans_type_ (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_type_attributes ((kind, body) : mt) : CST.type_attributes =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_type_attribute (Run.matcher_token v0),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_type_attribute (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v1
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_typecast_expression ((kind, body) : mt) : CST.typecast_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            trans_expression_inner (Run.matcher_token v0),
            (match v1 with
            | Alt (0, v) ->
                `COLON (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `COLONGT (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (2, v) ->
                `COLONQMARK (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (3, v) ->
                `COLONQMARKGT (
                  Run.trans_token (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_type_ (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_typed_expression ((kind, body) : mt) : CST.typed_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            trans_expression_inner (Run.matcher_token v0),
            trans_imm_tok_lt (Run.matcher_token v1),
            Run.opt
              (fun v -> trans_types (Run.matcher_token v))
              v2
            ,
            Run.trans_token (Run.matcher_token v3)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_typed_pattern ((kind, body) : mt) : CST.typed_pattern =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            trans_pattern (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_type_ (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_types ((kind, body) : mt) : CST.types =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_type_ (Run.matcher_token v0),
            Run.repeat1
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_type_ (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v1
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_value_declaration_left ((kind, body) : mt) : CST.value_declaration_left =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            Run.opt
              (fun v -> Run.trans_token (Run.matcher_token v))
              v0
            ,
            Run.opt
              (fun v ->
                (match v with
                | Alt (0, v) ->
                    `Priv (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (1, v) ->
                    `Inte (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (2, v) ->
                    `Public (
                      Run.trans_token (Run.matcher_token v)
                    )
                | _ -> assert false
                )
              )
              v1
            ,
            trans_pattern (Run.matcher_token v2),
            Run.opt
              (fun v -> trans_type_arguments (Run.matcher_token v))
              v3
            ,
            Run.opt
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_type_ (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v4
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_while_expression ((kind, body) : mt) : CST.while_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5; v6] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_expression_inner (Run.matcher_token v1),
            Run.trans_token (Run.matcher_token v2),
            trans_virtual_open_section (Run.matcher_token v3),
            trans_expressions (Run.matcher_token v4),
            trans_virtual_end_section (Run.matcher_token v5),
            Run.opt
              (fun v -> Run.trans_token (Run.matcher_token v))
              v6
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_with_field_expression ((kind, body) : mt) : CST.with_field_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            trans_expressions (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_virtual_open_section (Run.matcher_token v2),
            trans_field_initializers (Run.matcher_token v3),
            trans_virtual_end_section (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

and trans_yield_expression ((kind, body) : mt) : CST.yield_expression =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `Yield (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Yiel (
                  Run.trans_token (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            trans_expression_inner (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_enum_type_cases ((kind, body) : mt) : CST.enum_type_cases =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.opt
              (fun v -> Run.trans_token (Run.matcher_token v))
              v0
            ,
            trans_enum_type_case (Run.matcher_token v1),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1; v2] ->
                    (
                      trans_virtual_end_decl (Run.matcher_token v0),
                      Run.trans_token (Run.matcher_token v1),
                      trans_enum_type_case (Run.matcher_token v2)
                    )
                | _ -> assert false
                )
              )
              v2
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_union_type_field ((kind, body) : mt) : CST.union_type_field =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Type (
            trans_type_ (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Id_COLON_type (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  trans_identifier (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  trans_type_ (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false



let trans_class_inherits_decl ((kind, body) : mt) : CST.class_inherits_decl =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_type_ (Run.matcher_token v1),
            trans_virtual_open_section (Run.matcher_token v2),
            Run.opt
              (fun v -> trans_expressions (Run.matcher_token v))
              v3
            ,
            trans_virtual_end_section (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_type_name ((kind, body) : mt) : CST.type_name =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.opt
              (fun v -> trans_attributes (Run.matcher_token v))
              v0
            ,
            Run.opt
              (fun v ->
                (match v with
                | Alt (0, v) ->
                    `Priv (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (1, v) ->
                    `Inte (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (2, v) ->
                    `Public (
                      Run.trans_token (Run.matcher_token v)
                    )
                | _ -> assert false
                )
              )
              v1
            ,
            (match v2 with
            | Alt (0, v) ->
                `Id_opt_type_args (
                  (match v with
                  | Seq [v0; v1] ->
                      (
                        trans_identifier (Run.matcher_token v0),
                        Run.opt
                          (fun v -> trans_type_arguments (Run.matcher_token v))
                          v1
                      )
                  | _ -> assert false
                  )
                )
            | Alt (1, v) ->
                `Opt_type_arg_id (
                  (match v with
                  | Seq [v0; v1] ->
                      (
                        Run.opt
                          (fun v -> trans_type_argument (Run.matcher_token v))
                          v0
                        ,
                        trans_identifier (Run.matcher_token v1)
                      )
                  | _ -> assert false
                  )
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_do_ ((kind, body) : mt) : CST.do_ =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            Run.trans_token (Run.matcher_token v0),
            trans_virtual_open_section (Run.matcher_token v1),
            trans_expressions (Run.matcher_token v2),
            trans_virtual_end_section (Run.matcher_token v3)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let rec trans_simple_pattern ((kind, body) : mt) : CST.simple_pattern =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Id (
            trans_identifier (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Simple_pat_COLON_type (
            (match v with
            | Seq [v0; v1; v2] ->
                (
                  trans_simple_pattern (Run.matcher_token v0),
                  Run.trans_token (Run.matcher_token v1),
                  trans_type_ (Run.matcher_token v2)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_type_defn_elements ((kind, body) : mt) : CST.type_defn_elements =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Member_defns (
            trans_member_defns (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Inte_imples (
            trans_interface_implementations (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_record_field ((kind, body) : mt) : CST.record_field =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5] ->
          (
            Run.opt
              (fun v -> trans_attributes (Run.matcher_token v))
              v0
            ,
            Run.opt
              (fun v -> Run.trans_token (Run.matcher_token v))
              v1
            ,
            Run.opt
              (fun v ->
                (match v with
                | Alt (0, v) ->
                    `Priv (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (1, v) ->
                    `Inte (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (2, v) ->
                    `Public (
                      Run.trans_token (Run.matcher_token v)
                    )
                | _ -> assert false
                )
              )
              v2
            ,
            trans_identifier (Run.matcher_token v3),
            Run.trans_token (Run.matcher_token v4),
            trans_type_ (Run.matcher_token v5)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_class_function_or_value_defn ((kind, body) : mt) : CST.class_function_or_value_defn =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.opt
              (fun v -> trans_attributes (Run.matcher_token v))
              v0
            ,
            Run.opt
              (fun v -> Run.trans_token (Run.matcher_token v))
              v1
            ,
            (match v2 with
            | Alt (0, v) ->
                `Func_or_value_defn (
                  trans_function_or_value_defn (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Do_virt_open_sect_expres_virt_end_sect (
                  (match v with
                  | Seq [v0; v1; v2; v3] ->
                      (
                        Run.trans_token (Run.matcher_token v0),
                        trans_virtual_open_section (Run.matcher_token v1),
                        trans_expressions (Run.matcher_token v2),
                        trans_virtual_end_section (Run.matcher_token v3)
                      )
                  | _ -> assert false
                  )
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false






let trans_delegate_signature ((kind, body) : mt) : CST.delegate_signature =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_type_ (Run.matcher_token v2)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_union_type_fields ((kind, body) : mt) : CST.union_type_fields =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_union_type_field (Run.matcher_token v0),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_union_type_field (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v1
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false


let trans_type_abbrev_defn ((kind, body) : mt) : CST.type_abbrev_defn =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            trans_type_name (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_virtual_open_section (Run.matcher_token v2),
            trans_type_ (Run.matcher_token v3),
            trans_virtual_end_section (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_enum_type_defn ((kind, body) : mt) : CST.enum_type_defn =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            trans_type_name (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_virtual_open_section (Run.matcher_token v2),
            trans_enum_type_cases (Run.matcher_token v3),
            trans_virtual_end_section (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_value_declaration ((kind, body) : mt) : CST.value_declaration =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Func_or_value_defn (
            trans_function_or_value_defn (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Do (
            trans_do_ (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_primary_constr_args ((kind, body) : mt) : CST.primary_constr_args =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            Run.opt
              (fun v -> trans_attributes (Run.matcher_token v))
              v0
            ,
            Run.opt
              (fun v ->
                (match v with
                | Alt (0, v) ->
                    `Priv (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (1, v) ->
                    `Inte (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (2, v) ->
                    `Public (
                      Run.trans_token (Run.matcher_token v)
                    )
                | _ -> assert false
                )
              )
              v1
            ,
            Run.trans_token (Run.matcher_token v2),
            Run.opt
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      trans_simple_pattern (Run.matcher_token v0),
                      Run.repeat
                        (fun v ->
                          (match v with
                          | Seq [v0; v1] ->
                              (
                                Run.trans_token (Run.matcher_token v0),
                                trans_simple_pattern (Run.matcher_token v1)
                              )
                          | _ -> assert false
                          )
                        )
                        v1
                    )
                | _ -> assert false
                )
              )
              v3
            ,
            Run.trans_token (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_type_extension_elements ((kind, body) : mt) : CST.type_extension_elements =
  match body with
  | Children v ->
      (match v with
      | Seq [v0] ->
          (
            (match v0 with
            | Alt (0, v) ->
                `With_virt_open_sect_type_defn_elemes_virt_end_sect (
                  (match v with
                  | Seq [v0; v1; v2; v3] ->
                      (
                        Run.trans_token (Run.matcher_token v0),
                        trans_virtual_open_section (Run.matcher_token v1),
                        trans_type_defn_elements (Run.matcher_token v2),
                        trans_virtual_end_section (Run.matcher_token v3)
                      )
                  | _ -> assert false
                  )
                )
            | Alt (1, v) ->
                `Type_defn_elemes (
                  trans_type_defn_elements (Run.matcher_token v)
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_record_fields ((kind, body) : mt) : CST.record_fields =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            trans_record_field (Run.matcher_token v0),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      trans_virtual_end_decl (Run.matcher_token v0),
                      trans_record_field (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v1
            ,
            Run.opt
              (fun v -> Run.trans_token (Run.matcher_token v))
              v2
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_class_type_body_inner ((kind, body) : mt) : CST.class_type_body_inner =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Class_inhers_decl (
            trans_class_inherits_decl (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Class_func_or_value_defn (
            trans_class_function_or_value_defn (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `Type_defn_elemes (
            trans_type_defn_elements (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false



let trans_delegate_type_defn ((kind, body) : mt) : CST.delegate_type_defn =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4] ->
          (
            trans_type_name (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_virtual_open_section (Run.matcher_token v2),
            trans_delegate_signature (Run.matcher_token v3),
            trans_virtual_end_section (Run.matcher_token v4)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_union_type_case ((kind, body) : mt) : CST.union_type_case =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            Run.opt
              (fun v -> trans_attributes (Run.matcher_token v))
              v0
            ,
            (match v1 with
            | Alt (0, v) ->
                `Id (
                  trans_identifier (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Id_of_union_type_fields (
                  (match v with
                  | Seq [v0; v1; v2] ->
                      (
                        trans_identifier (Run.matcher_token v0),
                        Run.trans_token (Run.matcher_token v1),
                        trans_union_type_fields (Run.matcher_token v2)
                      )
                  | _ -> assert false
                  )
                )
            | Alt (2, v) ->
                `Id_COLON_type (
                  (match v with
                  | Seq [v0; v1; v2] ->
                      (
                        trans_identifier (Run.matcher_token v0),
                        Run.trans_token (Run.matcher_token v1),
                        trans_type_ (Run.matcher_token v2)
                      )
                  | _ -> assert false
                  )
                )
            | _ -> assert false
            )
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false


let trans_type_extension ((kind, body) : mt) : CST.type_extension =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1] ->
          (
            trans_type_name (Run.matcher_token v0),
            trans_type_extension_elements (Run.matcher_token v1)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_record_type_defn ((kind, body) : mt) : CST.record_type_defn =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5; v6; v7; v8; v9] ->
          (
            trans_type_name (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_virtual_open_section (Run.matcher_token v2),
            Run.trans_token (Run.matcher_token v3),
            trans_virtual_open_section (Run.matcher_token v4),
            trans_record_fields (Run.matcher_token v5),
            trans_virtual_end_section (Run.matcher_token v6),
            Run.trans_token (Run.matcher_token v7),
            Run.opt
              (fun v ->
                trans_type_extension_elements (Run.matcher_token v)
              )
              v8
            ,
            trans_virtual_end_section (Run.matcher_token v9)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_class_type_body ((kind, body) : mt) : CST.class_type_body =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            trans_virtual_open_section (Run.matcher_token v0),
            trans_class_type_body_inner (Run.matcher_token v1),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      trans_virtual_end_decl (Run.matcher_token v0),
                      trans_class_type_body_inner (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v2
            ,
            trans_virtual_end_section (Run.matcher_token v3)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_union_type_cases ((kind, body) : mt) : CST.union_type_cases =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.opt
              (fun v -> Run.trans_token (Run.matcher_token v))
              v0
            ,
            trans_union_type_case (Run.matcher_token v1),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1] ->
                    (
                      Run.trans_token (Run.matcher_token v0),
                      trans_union_type_case (Run.matcher_token v1)
                    )
                | _ -> assert false
                )
              )
              v2
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_anon_type_defn ((kind, body) : mt) : CST.anon_type_defn =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5] ->
          (
            trans_type_name (Run.matcher_token v0),
            trans_primary_constr_args (Run.matcher_token v1),
            Run.trans_token (Run.matcher_token v2),
            trans_virtual_open_section (Run.matcher_token v3),
            trans_class_type_body (Run.matcher_token v4),
            trans_virtual_end_section (Run.matcher_token v5)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_union_type_defn ((kind, body) : mt) : CST.union_type_defn =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5] ->
          (
            trans_type_name (Run.matcher_token v0),
            Run.trans_token (Run.matcher_token v1),
            trans_virtual_open_section (Run.matcher_token v2),
            trans_union_type_cases (Run.matcher_token v3),
            Run.opt
              (fun v ->
                trans_type_extension_elements (Run.matcher_token v)
              )
              v4
            ,
            trans_virtual_end_section (Run.matcher_token v5)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_type_defn_body ((kind, body) : mt) : CST.type_defn_body =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Dele_type_defn (
            trans_delegate_type_defn (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Record_type_defn (
            trans_record_type_defn (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `Union_type_defn (
            trans_union_type_defn (Run.matcher_token v)
          )
      | Alt (3, v) ->
          `Anon_type_defn (
            trans_anon_type_defn (Run.matcher_token v)
          )
      | Alt (4, v) ->
          `Enum_type_defn (
            trans_enum_type_defn (Run.matcher_token v)
          )
      | Alt (5, v) ->
          `Type_abbrev_defn (
            trans_type_abbrev_defn (Run.matcher_token v)
          )
      | Alt (6, v) ->
          `Type_exte (
            trans_type_extension (Run.matcher_token v)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_type_definition ((kind, body) : mt) : CST.type_definition =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            Run.opt
              (fun v -> trans_attributes (Run.matcher_token v))
              v0
            ,
            Run.trans_token (Run.matcher_token v1),
            trans_type_defn_body (Run.matcher_token v2),
            Run.repeat
              (fun v ->
                (match v with
                | Seq [v0; v1; v2] ->
                    (
                      Run.opt
                        (fun v -> trans_attributes (Run.matcher_token v))
                        v0
                      ,
                      Run.trans_token (Run.matcher_token v1),
                      trans_type_defn_body (Run.matcher_token v2)
                    )
                | _ -> assert false
                )
              )
              v3
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let rec trans_module_defn ((kind, body) : mt) : CST.module_defn =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3; v4; v5; v6; v7] ->
          (
            Run.opt
              (fun v -> trans_attributes (Run.matcher_token v))
              v0
            ,
            Run.trans_token (Run.matcher_token v1),
            Run.opt
              (fun v ->
                (match v with
                | Alt (0, v) ->
                    `Priv (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (1, v) ->
                    `Inte (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (2, v) ->
                    `Public (
                      Run.trans_token (Run.matcher_token v)
                    )
                | _ -> assert false
                )
              )
              v2
            ,
            trans_identifier (Run.matcher_token v3),
            Run.trans_token (Run.matcher_token v4),
            trans_virtual_open_section (Run.matcher_token v5),
            Run.repeat1
              (fun v ->
                (match v with
                | Alt (0, v) ->
                    `Blk_comm (
                      trans_block_comment (Run.matcher_token v)
                    )
                | Alt (1, v) ->
                    `Line_comm (
                      trans_line_comment (Run.matcher_token v)
                    )
                | Alt (2, v) ->
                    `Value_decl (
                      trans_value_declaration (Run.matcher_token v)
                    )
                | Alt (3, v) ->
                    `Module_defn (
                      trans_module_defn (Run.matcher_token v)
                    )
                | Alt (4, v) ->
                    `Module_abbrev (
                      trans_module_abbrev (Run.matcher_token v)
                    )
                | Alt (5, v) ->
                    `Import_decl (
                      trans_import_decl (Run.matcher_token v)
                    )
                | Alt (6, v) ->
                    `Comp_dire_decl (
                      trans_compiler_directive_decl (Run.matcher_token v)
                    )
                | Alt (7, v) ->
                    `Fsi_dire_decl (
                      trans_fsi_directive_decl (Run.matcher_token v)
                    )
                | Alt (8, v) ->
                    `Type_defi (
                      trans_type_definition (Run.matcher_token v)
                    )
                | _ -> assert false
                )
              )
              v6
            ,
            trans_virtual_end_section (Run.matcher_token v7)
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_named_module ((kind, body) : mt) : CST.named_module =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2; v3] ->
          (
            Run.trans_token (Run.matcher_token v0),
            Run.opt
              (fun v ->
                (match v with
                | Alt (0, v) ->
                    `Priv (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (1, v) ->
                    `Inte (
                      Run.trans_token (Run.matcher_token v)
                    )
                | Alt (2, v) ->
                    `Public (
                      Run.trans_token (Run.matcher_token v)
                    )
                | _ -> assert false
                )
              )
              v1
            ,
            trans_long_identifier (Run.matcher_token v2),
            Run.repeat
              (fun v ->
                (match v with
                | Alt (0, v) ->
                    `Blk_comm (
                      trans_block_comment (Run.matcher_token v)
                    )
                | Alt (1, v) ->
                    `Line_comm (
                      trans_line_comment (Run.matcher_token v)
                    )
                | Alt (2, v) ->
                    `Value_decl (
                      trans_value_declaration (Run.matcher_token v)
                    )
                | Alt (3, v) ->
                    `Module_defn (
                      trans_module_defn (Run.matcher_token v)
                    )
                | Alt (4, v) ->
                    `Module_abbrev (
                      trans_module_abbrev (Run.matcher_token v)
                    )
                | Alt (5, v) ->
                    `Import_decl (
                      trans_import_decl (Run.matcher_token v)
                    )
                | Alt (6, v) ->
                    `Comp_dire_decl (
                      trans_compiler_directive_decl (Run.matcher_token v)
                    )
                | Alt (7, v) ->
                    `Fsi_dire_decl (
                      trans_fsi_directive_decl (Run.matcher_token v)
                    )
                | Alt (8, v) ->
                    `Type_defi (
                      trans_type_definition (Run.matcher_token v)
                    )
                | _ -> assert false
                )
              )
              v3
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

let trans_namespace ((kind, body) : mt) : CST.namespace =
  match body with
  | Children v ->
      (match v with
      | Seq [v0; v1; v2] ->
          (
            Run.trans_token (Run.matcher_token v0),
            (match v1 with
            | Alt (0, v) ->
                `Global (
                  Run.trans_token (Run.matcher_token v)
                )
            | Alt (1, v) ->
                `Long_id (
                  trans_long_identifier (Run.matcher_token v)
                )
            | _ -> assert false
            )
            ,
            Run.repeat
              (fun v ->
                (match v with
                | Alt (0, v) ->
                    `Blk_comm (
                      trans_block_comment (Run.matcher_token v)
                    )
                | Alt (1, v) ->
                    `Line_comm (
                      trans_line_comment (Run.matcher_token v)
                    )
                | Alt (2, v) ->
                    `Value_decl (
                      trans_value_declaration (Run.matcher_token v)
                    )
                | Alt (3, v) ->
                    `Module_defn (
                      trans_module_defn (Run.matcher_token v)
                    )
                | Alt (4, v) ->
                    `Module_abbrev (
                      trans_module_abbrev (Run.matcher_token v)
                    )
                | Alt (5, v) ->
                    `Import_decl (
                      trans_import_decl (Run.matcher_token v)
                    )
                | Alt (6, v) ->
                    `Comp_dire_decl (
                      trans_compiler_directive_decl (Run.matcher_token v)
                    )
                | Alt (7, v) ->
                    `Fsi_dire_decl (
                      trans_fsi_directive_decl (Run.matcher_token v)
                    )
                | Alt (8, v) ->
                    `Type_defi (
                      trans_type_definition (Run.matcher_token v)
                    )
                | _ -> assert false
                )
              )
              v2
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false


let trans_file ((kind, body) : mt) : CST.file =
  match body with
  | Children v ->
      (match v with
      | Alt (0, v) ->
          `Named_module (
            trans_named_module (Run.matcher_token v)
          )
      | Alt (1, v) ->
          `Name (
            trans_namespace (Run.matcher_token v)
          )
      | Alt (2, v) ->
          `Rep1_choice_blk_comm (
            Run.repeat1
              (fun v ->
                (match v with
                | Alt (0, v) ->
                    `Blk_comm (
                      trans_block_comment (Run.matcher_token v)
                    )
                | Alt (1, v) ->
                    `Line_comm (
                      trans_line_comment (Run.matcher_token v)
                    )
                | Alt (2, v) ->
                    `Value_decl (
                      trans_value_declaration (Run.matcher_token v)
                    )
                | Alt (3, v) ->
                    `Module_defn (
                      trans_module_defn (Run.matcher_token v)
                    )
                | Alt (4, v) ->
                    `Module_abbrev (
                      trans_module_abbrev (Run.matcher_token v)
                    )
                | Alt (5, v) ->
                    `Import_decl (
                      trans_import_decl (Run.matcher_token v)
                    )
                | Alt (6, v) ->
                    `Comp_dire_decl (
                      trans_compiler_directive_decl (Run.matcher_token v)
                    )
                | Alt (7, v) ->
                    `Fsi_dire_decl (
                      trans_fsi_directive_decl (Run.matcher_token v)
                    )
                | Alt (8, v) ->
                    `Type_defi (
                      trans_type_definition (Run.matcher_token v)
                    )
                | _ -> assert false
                )
              )
              v
          )
      | _ -> assert false
      )
  | Leaf _ -> assert false

(*
   Costly operation that translates a whole tree or subtree.

   The first pass translates it into a generic tree structure suitable
   to guess which node corresponds to each grammar rule.
   The second pass is a translation into a typed tree where each grammar
   node has its own type.

   This function is called:
   - once on the root of the program after removing extras
     (comments and other nodes that occur anywhere independently from
     the grammar);
   - once of each extra node, resulting in its own independent tree of type
     'extra'.
*)
let translate_tree src node trans_x =
  let matched_tree = Run.match_tree children_regexps src node in
  Option.map trans_x matched_tree


let translate_extra src (node : Tree_sitter_output_t.node) : CST.extra option =
  None

let translate_root src root_node =
  translate_tree src root_node trans_file

let parse_input_tree input_tree =
  let orig_root_node = Tree_sitter_parsing.root input_tree in
  let src = Tree_sitter_parsing.src input_tree in
  let errors = Run.extract_errors src orig_root_node in
  let opt_program, extras =
     Run.translate
       ~extras
       ~translate_root:(translate_root src)
       ~translate_extra:(translate_extra src)
       orig_root_node
  in
  Parsing_result.create src opt_program extras errors

let string ?src_file contents =
  let input_tree = parse_source_string ?src_file contents in
  parse_input_tree input_tree

let file src_file =
  let input_tree = parse_source_file src_file in
  parse_input_tree input_tree

